(this["webpackJsonpref-data-management"]=this["webpackJsonpref-data-management"]||[]).push([[0],{123:function(e,t,a){e.exports=a(199)},132:function(e,t,a){},198:function(e,t,a){},199:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"sets",(function(){return ke})),a.d(n,"maps",(function(){return we})),a.d(n,"map_of_sets",(function(){return ge})),a.d(n,"tables",(function(){return xe})),a.d(n,"setAddItem",(function(){return Ee})),a.d(n,"setBulkAddItems",(function(){return Se})),a.d(n,"setImportItems",(function(){return Ie})),a.d(n,"mapAddItem",(function(){return Oe})),a.d(n,"mapBulkAddItems",(function(){return _e})),a.d(n,"mapImportItems",(function(){return De})),a.d(n,"map_of_setsAddItem",(function(){return je})),a.d(n,"map_of_setsAddInnerItem",(function(){return Ce})),a.d(n,"map_of_setsImportItems",(function(){return Te})),a.d(n,"map_of_setsBulkAddItems",(function(){return Me})),a.d(n,"tableAddItem",(function(){return Ae})),a.d(n,"tableAddInnerItem",(function(){return Le})),a.d(n,"tableImportItems",(function(){return Re})),a.d(n,"tableBulkAddItems",(function(){return Ne}));var r,s=a(0),l=a.n(s),o=a(55),i=a.n(o),u=a(19),c=a(7),d=a(3),p=a.n(d),m=a(6),f=a(11),h=a(20),b=a(13),v=a(12),y=a(14),k=a(223),w=a(224),g=a(112),x=a.n(g),E=(a(131),a(132),a(9)),S=a(16),I=a(208),O=a(200),_=a(209),D=a(201),j=a(210),C=a(211),T=a(212),M=a(81),A=a(120);M.a.use(A.a).init({resources:{en:{translations:{"data.sidebar.search":"Search","data.sidebar.create":"Create New","data.sidebar.type":"Reference $t({{type}})","data.table.elements.delete.set":"Delete Set","data.table.elements.delete.map":"Delete Map","data.table.elements.delete.map_of_sets":"Delete Map of Sets","data.table.elements.delete.table":"Delete Table","data.table.elements.add":"Add Entry","data.table.elements.bulk":"Bulk Add","data.table.elements.import":"Import from File","data.table.elements.export":"Export to File","data.table.elements.delete":"Delete","data.meta.elements.purge":"Clear Data","data.meta.elements.count":"Number of Elements","data.meta.elements.creation":"Creation Time","data.meta.elements.type.value":"Value Type","data.meta.elements.types.value":"Value Types","data.meta.elements.type.key":"Key Type","data.meta.elements.types.key":"Key Types","data.meta.elements.ttl":"Time To Live","data.meta.elements.ttl.forever":"Forever","data.meta.elements.timeout":"Timeout Type","data.dependents.title":"Dependents","data.dependents.none":"This ReferenceData appears to not have any data depending on it","carbon.table.pagination.items.per.page":"Items per page","carbon.table.pagination.pages.total":"of {{total}} pages ","carbon.table.pagination.items.total":"{{min}}\u2013{{max}} of {{total}} items","carbon.table.batch.cancel":"Cancel","carbon.table.batch.items.selected":"{{totalSelected}} items selected","carbon.table.batch.item.selected":"{{totalSelected}} item selected","carbon.table.toolbar.search.label":"Filter table","carbon.table.toolbar.search.placeholder":"Filter table","data.new.title":"Add new Reference {{type}} to Database","data.new.create":"Create","data.new.add.key.inner":"Add Inner Key","data.new.elementtype":"Element Type","data.new.timeout":"Timeout Type","data.new.ttl":"Time to Live","data.new.name":"Reference $t({{name}}) Name","data.new.name.help":"Required: The name of the $t({{name}}) to be created. Must not exist already","data.new.key":"Key Label","data.new.key.type":"Key Type","data.new.key.outer":"Outer Key Label","data.new.value":"Value Label","data.table.elements.add.separator.help":"New lines are implicit separators","data.table.elements.add.source.help":"Optional: A comment to add to the new data entry","data.table.elements.add.title":"Add Entry","data.table.elements.add.entries":"Entries","data.table.elements.add.save":"Save","data.table.elements.add.close":"Close","data.table.elements.add.file":"File","data.table.elements.add.file.placeholder":"Drag and drop file here or click to upload","data.table.elements.add.source":"Comment",Set:"Set",Map:"Map","Map of Sets":"Map of Sets",Table:"Table"}},de:{translations:(r={"data.sidebar.search":"Suchen","data.sidebar.create":"Hinzuf\xfcgen","data.sidebar.type":"Referenz $t({{type}})","data.table.elements.delete.data":"Set l\xf6schen","data.table.elements.delete.map":"Map l\xf6schen","data.table.elements.delete.map_of_sets":"Map of Sets l\xf6schen","data.table.elements.delete.table":"Tabelle l\xf6schen","data.table.elements.add":"Eintrag hinzuf\xfcgen","data.table.elements.bulk":"Mehrere hinzuf\xfcgen","data.table.elements.import":"Datei importieren","data.table.elements.export":"Exportieren","data.table.elements.delete":"L\xf6schen","data.meta.elements.purge":"Daten l\xf6schen","data.meta.elements.count":"Anzahl Elemente","data.meta.elements.creation":"Erstelldatum","data.meta.elements.type.value":"Werttyp","data.meta.elements.types.value":"Werttypen","data.meta.elements.type.key":"Schl\xfcsseltyp","data.meta.elements.types.key":"Schl\xfcsseltypen","data.meta.elements.ttl":"Ablaufzeitraum","data.meta.elements.ttl.forever":"Nie","data.meta.elements.timeout":"Ablauftyp","data.dependents.title":"Abh\xe4ngigkeiten","data.dependents.none":"F\xfcr diesen Eintrag scheint es keine Abh\xe4ngigkeiten zu geben","carbon.table.pagination.items.per.page":"Elemente pro Seite","carbon.table.pagination.pages.total":"von {{total}} Seiten","carbon.table.pagination.items.total":"{{min}}\u2013{{max}} von {{total}} Elementen","carbon.table.batch.cancel":"Abbrechen","carbon.table.batch.item.selected":"{{totalSelected}} Element ausgew\xe4hlt","carbon.table.batch.items.selected":"{{totalSelected}} Elemente ausgew\xe4hlt","carbon.table.toolbar.search.label":"Tabelle durchsuchen","carbon.table.toolbar.search.placeholder":"Tabelle durchsuchen","data.new.title":"Erstelle Referenz $t({{type}}) in Datenbank","data.new.create":"Hinzuf\xfcgen","data.new.add.key.inner":"Inneren Schl\xfcssel hinzuf\xfcgen","data.new.elementtype":"Element Typ","data.new.timeout":"Ablauftyp","data.new.ttl":"Ablaufzeitraum","data.new.name":"Name des/r Referenz $t({{name}})","data.new.name.help":"Verpflichtend: Der Name f\xfcr den zu erstellenden Referenz $t({{name}}) Eintrag. Darf noch nicht existieren","data.new.key":"Bezeichnung f\xfcr Schl\xfcssel","data.new.key.type":"Datentyp des Schl\xfcssels","data.new.key.outer":"Bezeichnung f\xfcr \xe4u\xdferen Schl\xfcssel","data.new.value":"Bezeichnung f\xfcr Wert","data.table.elements.add.title":"Eintrag hinzuf\xfcgen","data.table.elements.add.save":"Hinzuf\xfcgen","data.table.elements.add.close":"Schlie\xdfen","data.table.elements.add.separator.help":"Zeilenumbr\xfcche sind implizite Separatoren","data.table.elements.add.source":"Kommentar","data.table.elements.add.source.help":"Optional: Kommentar f\xfcr den neuen Eintrag"},Object(E.a)(r,"data.table.elements.add.title","Eintrag hinzuf\xfcgen"),Object(E.a)(r,"data.table.elements.add.entries","Eintr\xe4ge"),Object(E.a)(r,"data.table.elements.add.file","Datei"),Object(E.a)(r,"data.table.elements.add.file.placeholder","Datei herziehen oder klicken um eine neue Datei hochzuladen"),Object(E.a)(r,"Set","Set"),Object(E.a)(r,"Map","Zuordnung"),Object(E.a)(r,"Map of Sets","Zuordnung von Gruppen"),Object(E.a)(r,"Table","Tabelle"),r)}},fallbackLng:"en",debug:!1,ns:["translations"],defaultNS:"translations",keySeparator:!1,interpolation:{escapeValue:!1}});var L=M.a;var R=function(e){var t=Object(s.useState)(""),a=Object(c.a)(t,2),n=a[0],r=a[1],o=Object(s.useState)({}),i=Object(c.a)(o,2),u=i[0],d=i[1];return l.a.createElement("div",{className:"menu"},l.a.createElement(I.a,{type:"text",labelText:L.t("data.sidebar.search"),placeHolderText:L.t("data.sidebar.search"),light:!0,onChange:function(e){r(e.target.value),d({sets:!0,maps:!0,map_of_sets:!0,tables:!0})},value:n}),l.a.createElement(O.a,null,Object.keys(e.refData).map((function(t){return l.a.createElement(_.a,{key:t,open:u[t],title:e.refData[t].label,className:"menu-title",onClick:function(){return function(e){d(Object(S.a)({},u,Object(E.a)({},e,!u[e])))}(t)}},l.a.createElement(D.a,{kind:"primary",size:"small",className:"btn-create-new",onClick:function(a){return e.createEntry(a,t)},key:"btn-"+t},L.t("data.sidebar.create")),l.a.createElement(j.a,{className:"menu-list"},void 0===e.refData[t].size?l.a.createElement(C.a,{paragraph:!0,lineCount:3,heading:!0}):Object.keys(e.refData[t].nodes).map((function(a){if(function(e){try{return e.match(new RegExp(n,"i"))}catch(t){return e.toLowerCase().includes(n.toLowerCase())}}(a)){var r=e.refData[t].nodes[a];return l.a.createElement(D.a,{kind:"ghost",size:"small",key:r.label,className:"menu-entry",onClick:function(t){return e.menuItemAction(t,r)}},r.label,l.a.createElement(T.a,{className:"menu-entry-badge"},r.size||"0"))}}))))}))))},N=a(113),z=a.n(N),F=a(37),V=a(114),K=a.n(V),P={apiRoot:"/api",refDataApi:"/reference_data/",rulesApi:"analytics/",ruleWizardBase:"/console/core/jsp/WizardFrame.jsp?action=edit&appName=qradar&pageId=rulewizard&ruleId=",newRuleWizardBase:"/console/core/jsp/WizardFrame.jsp?action=new&appName=qradar&pageId=rulewizard&type=",aqlSearch:"/console/qradar/jsp/ArielSearchWrapper.jsp?"+encodeURI("url=do/ariel/arielSearch?"),aqlSearchDefaults:encodeURIComponent("appName=EventViewer&pageId=EventList&dispatch=performSearch&value(searchMode)=AQL&value(timeRangeType)=aqlTime&"),aqlSearchDefaultsFlow:encodeURIComponent("appName=Surveillance&pageId=FlowList&dispatch=performSearch&value(searchMode)=AQL&value(timeRangeType)=aqlTime&"),popupSettings:"status=yes,scrollbars=yes,resizable=yes,",axiosHeaders:{"Content-Type":"text/plain",Version:"10.1"},colors:{cepForce:"#0530ad",cep:"#0062ff",lst:"#054719",bb:"#da1e28",rule:"#750e13",font:"white",fontDisabled:"lightgray",edge:"#a2b5ce",qradarBlue:"#4178be"},fontFace:'"IBM Helvetica Neue", "Helvetica Neue", Helvetica, Arial, Roboto, sans-serif'},B=function(e){return e?encodeURIComponent(encodeURIComponent(e)):void 0},H=!1,q="";try{var U=F.QRadar.getCurrentUser();U&&!U.error&&(H=!0),q=F.QRadar.getCookie(F.QRadar.QRADAR_CSRF)}catch(Qt){}function W(e,t,a,n,r){return G.apply(this,arguments)}function G(){return(G=Object(m.a)(p.a.mark((function e(t,a,n,r,s){var l,o,i,u;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=z.a.create(),(o=Object.assign({},P.axiosHeaders,s||{})).Version="8",l.defaults.timeout=6e5,i=Math.ceil(1e3*Math.random()),console.time("".concat(i,": ").concat(t," ").concat(a)),u={data:[]},H&&(o[F.QRadar.QRADAR_CSRF]=q),e.prev=8,e.next=11,l.request({method:t,url:P.apiRoot+a+(n?"?"+K.a.stringify(n):""),data:r||{},headers:o});case 11:u=e.sent,e.next=23;break;case 14:if(e.prev=14,e.t0=e.catch(8),console.log("Failed loading data from ".concat(a)),console.timeEnd("".concat(i,": ").concat(t," ").concat(a)),e.t0.response&&e.t0.response.data){e.next=22;break}return e.abrupt("return",{error:e.t0,message:"Failed performing the requested network operation"});case 22:return e.abrupt("return",{error:e.t0,message:e.t0.response.data.message});case 23:return console.timeEnd("".concat(i,": ").concat(t," ").concat(a)),e.abrupt("return",u.data);case 25:case"end":return e.stop()}}),e,null,[[8,14]])})))).apply(this,arguments)}function J(e,t,a,n){return Q.apply(this,arguments)}function Q(){return(Q=Object(m.a)(p.a.mark((function e(t,a,n,r){var s,l,o,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"GET","id, status, message",s=a,l=a.status,o=0,i=setInterval(Object(m.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o++,!("CANCELLED"===l||"CANCELING"===l||"EXCEPTION"===l||"CONFLICT"===l||o>50)){e.next=6;break}clearInterval(i),n({error:!0,message:s.message}),e.next=19;break;case 6:if("COMPLETED"!==l){e.next=15;break}if(clearInterval(i),!r){e.next=12;break}return e.next=11,W("GET",t+"/results",{});case 11:s=e.sent;case 12:n(s),e.next=19;break;case 15:return e.next=17,W("GET",t,{fields:"id, status, message"});case 17:s=e.sent,l=s.status;case 19:case"end":return e.stop()}}),e)}))),2e3);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(e){return $.apply(this,arguments)}function $(){return($=Object(m.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="/reference_data/".concat(t),"GET",e.next=4,W("GET",a);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(e,t){return X.apply(this,arguments)}function X(){return(X=Object(m.a)(p.a.mark((function e(t,a){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="/reference_data/".concat(t),"POST",e.next=4,W("POST",n,a);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ee(e,t,a){return te.apply(this,arguments)}function te(){return(te=Object(m.a)(p.a.mark((function e(t,a,n){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="/reference_data/".concat(t,"/").concat(B(a)),"GET",e.next=4,W("GET",r,void 0,void 0,n);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ae(e,t,a,n){return ne.apply(this,arguments)}function ne(){return(ne=Object(m.a)(p.a.mark((function e(t,a,n,r){var s,l,o,i,u,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s="/reference_data/".concat(t,"/").concat(B(a),"/dependents"),l="GET",o="status, id, message",e.prev=2,a){e.next=5;break}throw new Error;case 5:return e.next=7,W(l,s,{fields:o});case 7:if((i=e.sent)&&i.id){e.next=10;break}throw new Error;case 10:if(u=i.status||"CANCELLED","maps"===t?t="map":"sets"===t&&(t="set"),c="/reference_data/".concat(t,"_dependent_tasks/").concat(i.id),!r){e.next=17;break}return e.abrupt("return",i);case 17:J(c,u,n,!0);case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(2),n({error:e.t0,message:"Unable to load dependents"});case 23:case"end":return e.stop()}}),e,null,[[2,20]])})))).apply(this,arguments)}function re(e,t,a){return se.apply(this,arguments)}function se(){return(se=Object(m.a)(p.a.mark((function e(t,a,n){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="/reference_data/".concat(t,"/").concat(B(a)),"POST",e.next=4,W("POST",r,n);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function le(e,t,a,n){return oe.apply(this,arguments)}function oe(){return(oe=Object(m.a)(p.a.mark((function e(t,a,n,r){var s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s="/reference_data/".concat(t,"/").concat(B(a),"/").concat(B(n)),"DELETE",e.next=4,W("DELETE",s,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ie(){return(ie=Object(m.a)(p.a.mark((function e(t,a,n,r){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ue(t,a,n,!0,r);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ue(e,t,a){return ce.apply(this,arguments)}function ce(){return(ce=Object(m.a)(p.a.mark((function e(t,a,n){var r,s,l,o,i,u,c,d=arguments;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=d.length>3&&void 0!==d[3]&&d[3],s=d.length>4&&void 0!==d[4]&&d[4],l="/reference_data/".concat(t,"/").concat(B(a)),o="DELETE",e.prev=4,a){e.next=7;break}throw new Error;case 7:return e.next=9,W(o,l,{purge_only:r});case 9:if((i=e.sent)&&i.id){e.next=12;break}throw new Error;case 12:if(u=i.status,"maps"===t?t="map":"sets"===t&&(t="set"),c="/reference_data/".concat(t,"_delete_tasks/").concat(i.id),n&&!s){e.next=19;break}return e.abrupt("return",i);case 19:J(c,u,n);case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(4),n({error:e.t0,message:e.t0.message||"Unable to delete Reference Data"});case 25:case"end":return e.stop()}}),e,null,[[4,22]])})))).apply(this,arguments)}function de(e,t,a,n,r){return pe.apply(this,arguments)}function pe(){return(pe=Object(m.a)(p.a.mark((function e(t,a,n,r,s){var l;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l="/reference_data/".concat(t,"/").concat(B(a),"/").concat(B(n),"/").concat(B(r)),"DELETE",e.next=4,W("DELETE",l,s);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function me(e,t,a){return fe.apply(this,arguments)}function fe(){return(fe=Object(m.a)(p.a.mark((function e(t,a,n){var r,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="/reference_data/".concat(t,"/bulk_load/").concat(B(a)),"POST",(s={})["Content-Type"]="application/json",e.next=6,W("POST",r,{},n,s);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function he(e,t){t=t||",";for(var a=new RegExp("(\\"+t+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+t+"\\r\\n]*))","gi"),n=[[]],r=null;r=a.exec(e);){var s,l=r[1];l.length&&l!==t&&n.push([]),s=r[2]?r[2].replace(new RegExp('""',"g"),'"'):r[3],n[n.length-1].push(s.trim())}return n.filter((function(e){return e.some((function(e){return e}))}))}var be=["ALN","NUM","IP","PORT","ALNIC","DATE"],ve=["FIRST_SEEN","LAST_SEEN"],ye=["mons","days","hours","minutes","seconds"],ke={name:{value:"",type:"text",label:L.t("data.new.name",{name:"Set"}),help:L.t("data.new.name.help",{name:"Set"})},element_type:{value:"ALN",type:"select",label:L.t("data.new.elementtype"),options:be,help:"Required: The data type of the values in the new Set"},timeout_type:{value:"FIRST_SEEN",type:"select",label:L.t("data.new.timeout"),options:ve,help:"Optional: The value based on which new data expires from the Set"},time_to_live:{value:"",type:"date",options:ye,label:L.t("data.new.ttl"),help:"Optional: If given, the entries of the set expire"}},we={name:{value:"",type:"text",label:L.t("data.new.name",{name:"Map"}),help:L.t("data.new.name.help",{name:"Map"})},element_type:{value:"ALN",type:"select",label:L.t("data.new.elementtype"),options:be,help:"Required: The data type of the values in the new Map"},timeout_type:{value:"FIRST_SEEN",type:"select",label:L.t("data.new.timeout"),options:ve,help:"Optional: The value based on which new data expires from the Map"},time_to_live:{value:"",type:"date",options:ye,label:L.t("data.new.ttl"),help:"Optional: If given, the entries of the Map expire"},key_label:{value:"",label:L.t("data.new.key"),type:"text",help:"Required: The label of the keys in the new Map"},value_label:{value:"",label:L.t("data.new.value"),type:"text",help:"Required: The label of the values in the new Map"}},ge={name:{value:"",type:"text",label:L.t("data.new.name",{name:"Map of Sets"}),help:L.t("data.new.name.help",{name:"Map of Sets"})},element_type:{value:"ALN",type:"select",label:L.t("data.new.elementtype"),options:be,help:"Required: The data type of the values in the new Map of Sets"},timeout_type:{value:"FIRST_SEEN",type:"select",label:L.t("data.new.timeout"),options:ve,help:"Optional: The value based on which new data expires from the Map of Sets"},time_to_live:{value:"",type:"date",options:ye,label:L.t("data.new.ttl"),help:"Optional: If given, the entries of the Map of Sets expire"},key_label:{value:"",label:L.t("data.new.key"),type:"text",help:"Required: The label of the keys in the new Map of Sets"},value_label:{value:"",label:L.t("data.new.value"),type:"text",help:"Required: The label of the values in the new Map of Sets"}},xe={name:{value:"",type:"text",label:L.t("data.new.name",{name:"Table"}),help:L.t("data.new.name.help",{name:"Table"})},timeout_type:{value:"FIRST_SEEN",type:"select",label:L.t("data.new.timeout"),options:ve,help:"Optional: The value based on which new data expires from the Table"},time_to_live:{value:"",type:"date",options:ye,label:L.t("data.new.ttl"),help:"Optional: If given, the entries of the Table expire"},key_label:{value:L.t("data.new.key.outer"),label:L.t("data.new.key"),type:"text",help:"Required: The label of the keys in the new Table"},element_type:{value:"ALN",type:"select",label:L.t("data.new.key.type"),options:be,help:"Required: The data type of the Outer Keys in the new Table"},inner_labels:{label:"Inner Keys",options:be,type:"list",values:{"Inner Key 1":{label:"Inner Key 1",type:"ALN"}},help:"Required: The data type of the Inner Keys in the new Table"}},Ee={value:{label:"Value",value:"",type:"text"},source:{value:"",label:L.t("data.table.elements.add.source"),type:"text",help:L.t("data.table.elements.add.source.help")}},Se={bulkAddData:{label:L.t("data.table.elements.add.entries"),value:"",type:"textarea"},bulkAddSeparator:{label:"Separator",value:",",help:L.t("data.table.elements.add.separator.help"),type:"text"}},Ie={file:{label:L.t("data.table.elements.add.file"),value:"",type:"file"},bulkAddSeparator:{label:"Separator",value:",",help:L.t("data.table.elements.add.separator.help"),type:"text"},containsHeaders:{label:"CSV contains headers",value:!0,help:"Whether the CSV has a headers row or not",type:"checkbox"}},Oe={key:{label:"Key",value:"",type:"text"},value:{label:"Value",value:"",type:"text"},source:{value:"",label:L.t("data.table.elements.add.source"),type:"text",help:L.t("data.table.elements.add.source.help")}},_e={bulkAddData:{label:L.t("data.table.elements.add.entries"),value:"",type:"textarea"},bulkAddSeparator:{label:"Key-Value Separator",value:",",type:"text"}},De={file:{label:L.t("data.table.elements.add.file"),value:"",type:"file"},bulkAddSeparator:{label:"Key-Value Separator",value:",",type:"text"},containsHeaders:{label:"CSV contains headers",value:!0,help:"Whether the CSV has a headers row or not",type:"checkbox"}},je={keyAddDataKey:{label:"Input Key",value:"",type:"text"},keyAddDataValues:{label:"Input Values",value:"",type:"textarea"},keyAddSeparator:{label:"Separator",value:",",help:L.t("data.table.elements.add.separator.help"),type:"text"}},Ce={value:{label:"Value",value:"",type:"text"},source:{value:"",label:L.t("data.table.elements.add.source"),type:"text",help:L.t("data.table.elements.add.source.help")}},Te={file:{label:L.t("data.table.elements.add.file"),value:"",type:"file"},bulkAddSeparator:{label:"Key-Value Separator",value:",",help:"Example Format: Key1,Value1\nKey1,Value2\nKey2,Value3, ...",type:"text"},containsHeaders:{label:"CSV contains headers",value:!0,help:"Whether the CSV has a headers row or not",type:"checkbox"}},Me={bulkAddData:{label:L.t("data.table.elements.add.entries"),value:"",type:"textarea"},bulkAddSeparator:{label:"Key-Value Separator",value:",",help:"Example Format: Key1,Value1\nKey1,Value2\nKey2,Value3, ...",type:"text"}},Ae={keyAddDataKey:{label:"Input Key",value:"",type:"text"},keyAddDataValues:{label:"Input Values",value:"",type:"textarea"},keyAddSeparator:{label:"Separator",value:",",help:L.t("data.table.elements.add.separator.help"),type:"text"}},Le={key:{label:"Key",value:"",type:"text"},value:{label:"Value",value:"",type:"text"},source:{value:"",label:L.t("data.table.elements.add.source"),type:"text",help:L.t("data.table.elements.add.source.help")}},Re={file:{label:L.t("data.table.elements.add.file"),value:"",type:"file"},bulkAddSeparator:{label:"Key-Value Separator",value:",",help:"Example Format: Parent Key, Inner Key, Value\n...",type:"text"},containsHeaders:{label:"CSV contains headers",value:!0,help:"Whether the CSV has a headers row or not",type:"checkbox"}},Ne={bulkAddData:{label:L.t("data.table.elements.add.entries"),value:"",type:"textarea"},bulkAddSeparator:{label:"Key-Value Separator",value:",",help:"Example Format: Parent Key, Inner Key, Value\n...",type:"text"}},ze=[{key:"value",header:"Value"},{key:"first_seen",header:"First Seen"},{key:"last_seen",header:"Last Seen"},{key:"source",header:"Source"}],Fe=[{key:"key",header:"Key"},{key:"value",header:"Value"},{key:"first_seen",header:"First Seen"},{key:"last_seen",header:"Last Seen"},{key:"source",header:"Source"}],Ve=[{key:"key",header:"Key"}],Ke=[{key:"value",header:"Value"},{key:"first_seen",header:"First Seen"},{key:"last_seen",header:"Last Seen"},{key:"source",header:"Source"}],Pe=[{key:"key",header:"Key"}],Be=[{key:"key",header:"Inner Key"},{key:"value",header:"Value"},{key:"first_seen",header:"First Seen"},{key:"last_seen",header:"Last Seen"},{key:"source",header:"Source"}],He=a(115),qe=a.n(He),Ue=a(56),We=a.n(Ue);function Ge(e){var t="",a=e.split(/(\S+\s\S+)/).filter((function(e){return e.trim()})),n=!0,r=!1,s=void 0;try{for(var l,o=a[Symbol.iterator]();!(n=(l=o.next()).done);n=!0){var i=l.value;0!=i.split(/\s/)[0]&&(t+=" "+i)}}catch(u){r=!0,s=u}finally{try{n||null==o.return||o.return()}finally{if(r)throw s}}return t}var Je=a(213),Qe=a(214),Ye=a(43);var $e=function(e){var t,a=[l.a.createElement(l.a.Fragment,null,L.t("data.meta.elements.count"),": ",l.a.createElement(T.a,{type:"gray"},e.data.number_of_elements||0)),l.a.createElement(l.a.Fragment,null,L.t("data.meta.elements.creation"),": ",e.data.creation_time?(t=e.data.creation_time,We()(t,"dd/mmm/yyyy, hh:MM:ss TT")):""),l.a.createElement(l.a.Fragment,null,L.t("data.meta.elements.timeout"),": ",e.data.timeout_type),l.a.createElement(l.a.Fragment,null,L.t("data.meta.elements.ttl"),": ",e.data.time_to_live?Ge(e.data.time_to_live):L.t("data.meta.elements.ttl.forever")),l.a.createElement(l.a.Fragment,null,L.t("data.meta.elements.type.value"),": ",e.data.element_type)],n=e.data.key_name_types&&"";if(void 0!==n){for(var r in e.data.key_name_types)n+=e.data.key_name_types[r]+" ("+r+"), ";a.splice(4,0,l.a.createElement(l.a.Fragment,null,L.t("data.meta.elements.types.key"),": ",n))}return l.a.createElement(l.a.Fragment,null,l.a.createElement(D.a,{kind:"danger",size:"small",className:"delete top right",onClick:e.deleteEntry},L.t("data.table.elements.delete."+e.typeLabel)),l.a.createElement(D.a,{kind:"danger",size:"small",className:"delete top-second right",onClick:e.purgeData},L.t("data.meta.elements.purge")),e.data.name?l.a.createElement(Je.e,{className:"meta-data"},l.a.createElement(Je.c,null,l.a.createElement(Je.d,{head:!0},l.a.createElement(Je.b,{head:!0,className:"meta-data-title"},e.data.name,l.a.createElement(D.a,{className:"reload",onClick:e.reload,kind:"ghost",size:"small",tooltipPosition:"bottom",renderIcon:Ye.c,iconDescription:"Refresh"})))),l.a.createElement(Je.a,null,a.map((function(e,t){return l.a.createElement(Je.d,{key:t},l.a.createElement(Je.b,{className:"meta-data-entry"},e))})))):l.a.createElement(Qe.a,{className:"meta-data"}))},Ze=a(225),Xe=a(78),et=a(79),tt=a(80),at=a(227),nt=Ze.a.TableContainer,rt=Ze.a.Table,st=Ze.a.TableHead,lt=Ze.a.TableRow,ot=Ze.a.TableBody,it=Ze.a.TableCell,ut=Ze.a.TableHeader,ct=Ze.a.TableToolbar,dt=Ze.a.TableSelectAll,pt=Ze.a.TableSelectRow,mt=Ze.a.TableBatchActions,ft=Ze.a.TableBatchAction,ht=Ze.a.TableToolbarContent,bt=Ze.a.TableToolbarSearch,vt=function(e){return We()(e,"dd/mmm/yyyy, hh:MM:ss TT")},yt=function(e){function t(e){var a;Object(f.a)(this,t),(a=Object(b.a)(this,Object(v.a)(t).call(this,e))).formatters={first_seen:vt,last_seen:vt},a.onInputChange=function(e){a.props.tableChanged("search",{searchText:e.target.value}),a.setState({firstRowIndex:0,currentPage:1,updatePagination:Math.random()})},a.sortTable=function(e){var t="ASC";e===a.state.sortHeader&&(t="ASC"===a.state.sortDirection?"DESC":"ASC");var n={ASC:[-1,1],DESC:[1,-1]};a.props.data.sort((function(a,r){return a[e]<r[e]?n[t][0]:n[t][1]})),a.setState({sortDirection:t,sortHeader:e})};var n=10;return e.data.length>1e4&&(n=100),e.data.length>1e5&&(n=1e3),a.state={currentPageSize:n,firstRowIndex:0,currentPage:1,updatePagination:Math.random(),sortDirection:"ASC"},a}return Object(y.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this,a=this.props.data.slice(this.state.firstRowIndex,this.state.firstRowIndex+this.state.currentPageSize);return l.a.createElement(Ze.a,{useZebraStyles:!0,isSortable:!0,rows:a,headers:this.props.headers,render:function(a){var n=a.rows,r=a.getRowProps,s=a.headers,o=a.getHeaderProps,i=a.selectedRows,u=a.getSelectionProps,d=a.getTableProps,p=a.getBatchActionProps;return l.a.createElement(nt,null,l.a.createElement(ct,null,l.a.createElement(mt,Object.assign({},p(),{translateWithId:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return L.t(e,{totalSelected:t.totalSelected})}}),l.a.createElement(ft,{renderIcon:Ye.b,onClick:function(t){return e.props.deleteItem(i)}},L.t("data.table.elements.delete"))),l.a.createElement(ht,null,!e.props.innerTable&&l.a.createElement(bt,{onChange:e.onInputChange,translateWithId:function(e){return L.t(e)}}),l.a.createElement(D.a,{onClick:e.props.addItem,size:"small",kind:"primary",className:"btn-table"},L.t("data.table.elements.add")),!e.props.innerTable&&l.a.createElement(l.a.Fragment,null,l.a.createElement(D.a,{onClick:e.props.bulkAddItem,size:"small",kind:"primary",className:"btn-table"},L.t("data.table.elements.bulk")),l.a.createElement(D.a,{onClick:e.props.importItems,size:"small",kind:"primary",className:"btn-table"},L.t("data.table.elements.import")),l.a.createElement(D.a,{onClick:e.props.exportItems,size:"small",kind:"primary",className:"btn-table"},L.t("data.table.elements.export"))))),l.a.createElement(rt,d(),l.a.createElement(st,null,l.a.createElement(lt,null,e.props.expandable&&l.a.createElement(Xe.a,{ariaLabel:"Expand Row",isExpanded:!0,onExpand:function(e){return e}}),l.a.createElement(dt,u()),s.map((function(t){return l.a.createElement(ut,Object.assign({},o({header:t}),{sortDirection:e.state.sortDirection,isSortHeader:e.state.sortHeader===t.key,onClick:function(){return e.sortTable(t.key)}}),t.header)})))),l.a.createElement(ot,null,e.props.expandable&&n.map((function(a){return l.a.createElement(l.a.Fragment,{key:a.id},l.a.createElement(et.a,r({row:a}),l.a.createElement(pt,u({row:a})),a.cells.map((function(e){return l.a.createElement(it,{key:e.id},e.value)}))),a.isExpanded&&l.a.createElement(tt.a,{colSpan:s.length+2},function(a){return l.a.createElement("div",{className:"inner-table"},l.a.createElement(t,{innerTable:!0,data:a.values,headers:e.props.extendableHeaders,addItem:function(t){return e.props.addInnerItem(a)},deleteItem:function(t){return e.props.deleteInnerItem(a.key,t)},searchText:e.props.innerSearchText}))}(e.props.data.find((function(e){return e.key===a.id})))))})),!e.props.expandable&&n.map((function(t){return l.a.createElement(lt,Object.assign({key:t.id},r({row:t})),l.a.createElement(pt,u({row:t})),t.cells.map((function(t){var a=t.id.split(":"),n=Object(c.a)(a,2),r=(n[0],n[1]),s=t.value;return r in e.formatters&&(s=e.formatters[r](s)),l.a.createElement(it,{key:t.id},s)})))})))),l.a.createElement(at.a,{key:e.state.currentPage*e.props.data.length*e.state.updatePagination,page:e.state.currentPage,pageSize:e.state.currentPageSize,pageSizes:[10,30,50,100,1e3],totalItems:e.props.data.length,itemsPerPageText:L.t("carbon.table.pagination.items.per.page"),pageRangeText:function(e,t){return L.t("carbon.table.pagination.pages.total",{total:t})},itemRangeText:function(e,t,a){return L.t("carbon.table.pagination.items.total",{min:e,max:t,total:a})},onChange:function(t){var a=t.page,n=t.pageSize;return e.setState({firstRowIndex:n*(a-1),currentPageSize:n})}}))}})}}]),t}(s.Component),kt=a(215),wt=a(216),gt=Ze.a.Table,xt=Ze.a.TableHead,Et=Ze.a.TableRow,St=Ze.a.TableBody,It=Ze.a.TableCell,Ot=Ze.a.TableHeader;var _t,Dt=function(e){var t;return t=e.dependents&&e.dependents.length>0?e.dependents.map((function(e,t){return{id:t,dependent:"("+e.dependent_type+") "+e.dependent_name}})):[{id:"0",dependent:L.t("data.dependents.none")}],e.loaded?l.a.createElement(Ze.a,{headers:[{header:L.t("data.dependents.title"),key:"dependent"}],rows:t,useZebraStyles:!0,render:function(t){var a=t.rows,n=t.headers,r=t.getTableProps,s=t.getHeaderProps,o=t.getRowProps;return l.a.createElement(gt,r(),l.a.createElement(xt,null,l.a.createElement(Et,null,n.map((function(e){return l.a.createElement(Ot,s({header:e}),e.header)})))),l.a.createElement(St,null,a.map((function(t){return l.a.createElement(Et,Object.assign({key:t.id},o({row:t})),t.cells.map((function(a){return l.a.createElement(It,{key:a.id},e.dependents&&e.dependents.length&&["CRE_RULE","BUILDING_BLOCK","ADE_RULE"].includes(e.dependents[t.id].dependent_type)?l.a.createElement(kt.a,{href:"#",onClick:function(a){a.preventDefault(),e.editRule(e.dependents[t.id].dependent_id)}},a.value):l.a.createElement(kt.a,null,a.value))})))}))))}}):l.a.createElement(wt.a,{headers:[L.t("data.dependents.title")],columnCount:1,rowCount:1})},jt=a(230),Ct=a(217),Tt=a(228),Mt=a(218),At=a(229),Lt=a(219),Rt=a(220),Nt=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(b.a)(this,Object(v.a)(t).call(this,e))).handleChange=function(e,t,n){var r=a.state.entries,s=a.state.filename;n?(r[t].value=n.addedFiles[0],s=n.addedFiles[0].name):"checkbox"===r[t].type?r[t].value=e:r[t].value=e.target.value,a.setState({entries:r,filename:s})},a.state={entries:a.props.entries,filename:"",show:!1},a}return Object(y.a)(t,e),Object(h.a)(t,[{key:"componentDidUpdate",value:function(){this.props.modal!==this.state.show&&this.setState({entries:JSON.parse(JSON.stringify(this.props.entries)),show:this.props.modal,filename:""})}},{key:"label",value:function(e){return this.state.entries[e].help?l.a.createElement(jt.a,{direction:"right",triggerText:this.state.entries[e].label},this.state.entries[e].help):l.a.createElement(Ct.a,null,this.state.entries[e].label)}},{key:"render",value:function(){var e=this,t=L.t("data.table.elements.add.file.placeholder");return l.a.createElement(Tt.a,{size:"sm",open:this.props.modal,onRequestSubmit:function(){e.props.save(e.state.entries),e.props.closeModal()},onRequestClose:this.props.closeModal,modalHeading:L.t("data.table.elements.add.title"),primaryButtonText:L.t("data.table.elements.add.save"),secondaryButtonText:L.t("data.table.elements.add.close")},l.a.createElement(Je.e,{className:"input-modal"},l.a.createElement(Je.a,null,Object.keys(this.state.entries).map((function(a){return l.a.createElement(Je.d,{className:"input-modal-entry"},{file:l.a.createElement(Mt.a,{id:a,multiple:!1,labelText:e.state.filename||t,onAddFiles:function(t,n){return e.handleChange(t,a,n)}}),text:l.a.createElement(At.a,{id:a,labelText:e.label(a),value:e.state.entries[a].value,onChange:function(t){return e.handleChange(t,a)}}),textarea:l.a.createElement(Lt.a,{id:a,labelText:e.label(a),value:e.state.entries[a].value,onChange:function(t){return e.handleChange(t,a)}}),checkbox:l.a.createElement(Rt.a,{defaultChecked:!0,id:a,labelText:e.label(a),value:e.state.entries[a].value,onChange:function(t){return e.handleChange(t,a)}})}[e.state.entries[a].type])})))))}}]),t}(s.Component),zt=function(e){function t(e,a){var r;return Object(f.a)(this,t),(r=Object(b.a)(this,Object(v.a)(t).call(this,e))).defaultEntryComment=Object(m.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!_t){e.next=2;break}return e.abrupt("return",_t);case 2:return e.prev=2,e.next=5,F.QRadar.getCurrentUser();case 5:(t=e.sent)&&!t.error&&(_t=t.username),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0);case 12:return e.abrupt("return",_t);case 14:case"end":return e.stop()}}),e,null,[[2,9]])}))),r.updateMetaData=function(e){var t=r.state.metaData;t.number_of_elements=e.number_of_elements,r.setState({metaData:t}),r.props.dataUpdated()},r.loadData=function(){var e=Object(m.a)(p.a.mark((function e(t){var a,n,s,l,o,i,c,d,m;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.loadDependents(),s=0,l=0,o=n=5e3;case 5:return i={Range:"items=".concat(l,"-").concat(o)},e.next=9,ee(r.props.type,r.props.name,i);case 9:if(!(a=e.sent).error){e.next=14;break}return r.props.showError("Unable to load all elements"),r.setState({loaded:!0}),e.abrupt("return");case 14:if(!r.props.size&&a.number_of_elements&&(s=a.number_of_elements),c=t?[]:r.state.allEntries,t=!1,!a.data){e.next=36;break}return m=r.parseResponseData(a),c?(d=c).push.apply(d,Object(u.a)(m)):c=m,e.next=22,r.setState({allEntries:c});case 22:if(delete a.data,r.tableChanged(),!(s&&s>o)){e.next=32;break}a.number_of_elements=o+1,r.setState({metaData:a}),l=o+1,o+=n,console.log("Loading next batch from ".concat(l," to ").concat(o)),e.next=34;break;case 32:return console.log("Done loading all elements"),e.abrupt("break",40);case 34:e.next=38;break;case 36:return console.log("Last batch did not return any new elements. Terminating"),e.abrupt("break",40);case 38:e.next=5;break;case 40:r.setState({metaData:a,loaded:!0});case 41:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.loadDependents=Object(m.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=function(e){if(e.error)return r.props.showError("Unable to load dependents"),void r.setState({dependentsLoaded:!0});r.setState({dependents:e,dependentsLoaded:!0})},ae(r.props.type,r.props.name,t);case 2:case"end":return e.stop()}}),e)}))),r.purgeData=function(){r.props.displayLoadingModal(!0);!function(e,t,a,n){ie.apply(this,arguments)}(r.props.type,r.props.name,(function(e){r.tableChanged("new",[]),r.updateMetaData(e),r.props.displayLoadingModal(!1)}))},r.reload=Object(m.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.props.displayLoadingModal(!0),e.next=3,r.loadData(!0);case 3:r.props.displayLoadingModal(!1);case 4:case"end":return e.stop()}}),e)}))),r.clickAddItem=function(){r.setState({showInputModal:!0,modalSave:r.addItem,modalInputDefinition:n[r.type+"AddItem"]})},r.clickAddInnerItem=function(e){r.setState({showInputModal:!0,modalSave:function(t){return r.addInnerItem(e,t)},modalInputDefinition:n[r.type+"AddInnerItem"]})},r.clickBulkAddItem=function(){r.setState({showInputModal:!0,modalSave:r.bulkAddItems,modalInputDefinition:n[r.type+"BulkAddItems"]})},r.clickImportItems=function(){r.setState({showInputModal:!0,modalSave:r.importItems,modalInputDefinition:n[r.type+"ImportItems"]})},r.clickDeleteItem=function(e){r.deleteItem(e)},r.clickDeleteInnerItem=function(e,t){r.deleteInnerItem(e,t)},r.tableChanged=function(e,t){var a=r.state.allEntries,n=r.state.searchText;"search"===e&&t&&(n=t.searchText),"new"===e&&t&&(a=t);var s=[],l=!1;try{n=new RegExp(n,"gi"),l=!0}catch(Qt){}var o=0,i=!0,u=!1,c=void 0;try{for(var d,p=a[Symbol.iterator]();!(i=(d=p.next()).done);i=!0){var m=d.value;r.testValue(m,n,l)&&(m.index=o++,s.push(m))}}catch(f){u=!0,c=f}finally{try{i||null==p.return||p.return()}finally{if(u)throw c}}r.setState({tableData:s,searchText:n,allEntries:a})},r.getIFrameDoc=function(e){return e.contentDocument||e.contentWindow.document},r.showEditRuleModal=function(e){if(r.state.editRuleModalOpen)r.closeRuleModal();else{r.setState((function(e){return{editRuleModalOpen:!0}}));var t=setInterval((function(){if(void 0!==window.frames.rulesWindow){window.frames.rulesWindow.location.href=P.ruleWizardBase+e,clearInterval(t);var a=0,n=setInterval((function(){try{var e=r.getIFrameDoc(document.getElementById("ruleWizardFrame")),t=r.getIFrameDoc(e.getElementById("navigation")),s=t.getElementById("closeButton");t.getElementById("finishButton").addEventListener("click",r.saveRule),s.addEventListener("click",r.closeRuleModal),clearInterval(n)}catch(l){a++>=20&&(clearInterval(n),console.log("Something went wrong with registering the close handlers for the frame. Frame can be closed by clicking in the window background"),console.log(l))}}),1e3)}}),100)}},r.saveRule=function(){setTimeout((function(){var e=this.getIFrameDoc(document.getElementById("ruleWizardFrame"));this.getIFrameDoc(e.getElementById("content")).getElementsByTagName("body")[0].hasAttribute("onload")?this.closeRuleModal():document.getElementsByClassName("errorMessage").length>0||this.saveRule()}),400)},r.closeRuleModal=function(){return r.setState({editRuleModalOpen:!1})},r.type=a,r.headers={set:ze,map:Fe,map_of_sets:Ve,map_of_setsInner:Ke,table:Pe,tableInner:Be},r.state={metaData:{},allEntries:[],tableData:[],loaded:!1,searchText:"",modalInputDefinition:{}},r.loadData(),r}return Object(y.a)(t,e),Object(h.a)(t,[{key:"download",value:function(e,t,a,n){var r="";n&&(r+="parentKey,"),a&&(r+="key,"),r+="value,first_seen,last_seen,source\n";var s=!0,l=!1,o=void 0;try{for(var i,u=t[Symbol.iterator]();!(s=(i=u.next()).done);s=!0){var c=i.value;n&&(r+='"'+c.outer_key.replace(/"/g,'""')+'",'),a&&(r+='"'+c.key.replace(/"/g,'""')+'",'),r+='"'+c.value.replace(/"/g,'""')+'","'+c.first_seen+'","'+c.last_seen+'","'+c.source.replace(/"/g,'""')+'"\n'}}catch(p){l=!0,o=p}finally{try{s||null==u.return||u.return()}finally{if(l)throw o}}var d=new Blob([r],{type:"text/csv"});qe.a.saveAs(d,"".concat(e,".csv"))}},{key:"render",value:function(){var e=this;return l.a.createElement(l.a.Fragment,null,l.a.createElement(Nt,{modal:this.state.showInputModal,save:this.state.modalSave,entries:JSON.parse(JSON.stringify(this.state.modalInputDefinition)),closeModal:function(t){return e.setState((function(e){return{showInputModal:!e.showInputModal}}))}}),l.a.createElement(Tt.a,{className:"rule-wizard-modal",size:"sm",open:this.state.editRuleModalOpen,passiveModal:!0,onRequestClose:this.closeRuleModal},l.a.createElement("iframe",{id:"ruleWizardFrame",name:"rulesWindow",className:"rule-wizard-frame"})),l.a.createElement($e,{data:this.state.metaData,typeLabel:this.type,deleteEntry:this.props.deleteEntry,purgeData:this.purgeData,reload:this.reload}),this.state.loaded?l.a.createElement(yt,{tableChanged:this.tableChanged,data:this.state.tableData,headers:this.headers[this.type],type:this.type,addItem:this.clickAddItem,bulkAddItem:this.clickBulkAddItem,importItems:this.clickImportItems,exportItems:this.exportItems,deleteItem:this.clickDeleteItem,searchText:this.state.searchText,expandable:["map_of_sets","table"].includes(this.type),extendableHeaders:this.headers[this.type+"Inner"],addInnerItem:this.clickAddInnerItem,deleteInnerItem:this.clickDeleteInnerItem,innerSearchText:this.state.innerSearchText}):l.a.createElement(wt.a,{rowCount:Math.min(10,this.props.size+1||1),columnCount:this.headers[this.type].length}),l.a.createElement("div",{className:"separator"}),l.a.createElement(Dt,{dependents:this.state.dependents,loaded:this.state.dependentsLoaded,editRule:this.showEditRuleModal}))}}]),t}(s.Component),Ft=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(b.a)(this,Object(v.a)(t).call(this,e,"set"))).addItem=function(){var e=Object(m.a)(p.a.mark((function e(t){var n,r,s,l,o,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.value.value){e.next=2;break}return e.abrupt("return");case 2:return a.props.displayLoadingModal(!0),e.next=5,a.defaultEntryComment();case 5:return n=e.sent,r=[t.value.value,t.source.value||n],s=r[0],l=r[1],e.next=9,re(a.props.type,a.props.name,{value:s,source:l});case 9:(o=e.sent).error?a.props.showError(o.message):o.number_of_elements>a.state.tableData.length&&((i=a.state.allEntries).push({value:s,source:l,id:s,first_seen:Date.now(),last_seen:Date.now()}),a.tableChanged("new",i),a.updateMetaData(o)),a.props.displayLoadingModal(!1);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.deleteItem=function(){var e=Object(m.a)(p.a.mark((function e(t){var n,r,s,l,o,i,u,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.length){e.next=2;break}return e.abrupt("return");case 2:a.props.displayLoadingModal(!0),r=a.state.allEntries,s=!0,l=!1,o=void 0,e.prev=7,i=p.a.mark((function e(){var t,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.value,s=t.id,e.next=4,le(a.props.type,a.props.name,s);case 4:n=e.sent,r=r.filter((function(e){return e.value!==s}));case 6:case"end":return e.stop()}}),e)})),u=t[Symbol.iterator]();case 10:if(s=(c=u.next()).done){e.next=15;break}return e.delegateYield(i(),"t0",12);case 12:s=!0,e.next=10;break;case 15:e.next=21;break;case 17:e.prev=17,e.t1=e.catch(7),l=!0,o=e.t1;case 21:e.prev=21,e.prev=22,s||null==u.return||u.return();case 24:if(e.prev=24,!l){e.next=27;break}throw o;case 27:return e.finish(24);case 28:return e.finish(21);case 29:n.error||n.number_of_elements>=a.state.tableData.length?a.props.showError(n.message||"Unspecified error while trying to delete value"):(a.tableChanged("new",r),a.updateMetaData(n)),a.props.displayLoadingModal(!1);case 31:case"end":return e.stop()}}),e,null,[[7,17,21,29],[22,,24,28]])})));return function(t){return e.apply(this,arguments)}}(),a.importItems=function(){var e=Object(m.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=new FileReader).onloadend=function(){var e=he(n.result,t.bulkAddSeparator.value);t.containsHeaders.value&&(e=e.slice(1));var r=[],s=!0,l=!1,o=void 0;try{for(var i,u=e[Symbol.iterator]();!(s=(i=u.next()).done);s=!0){var d=i.value,p=Object(c.a)(d,1)[0];r.push(p)}}catch(m){l=!0,o=m}finally{try{s||null==u.return||u.return()}finally{if(l)throw o}}a.bulkAdd(r)},t.file&&t.file.value&&n.readAsText(t.file.value);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.bulkAddItems=function(){var e=Object(m.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.bulkAddData.value.replace(/\r?\n/g,t.bulkAddSeparator.value).split(t.bulkAddSeparator.value).map((function(e){return e.trim()})).filter((function(e){return e})),n=Object(u.a)(new Set(n)),a.bulkAdd(n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.bulkAdd=function(){var e=Object(m.a)(p.a.mark((function e(t){var n,r,s,l,o,i,u,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.props.displayLoadingModal(!0),e.next=3,me(a.props.type,a.props.name,t);case 3:if(!(n=e.sent).error){e.next=8;break}a.props.showError(n.message),e.next=31;break;case 8:for(r=a.state.allEntries,s=!0,l=!1,o=void 0,e.prev=12,i=t[Symbol.iterator]();!(s=(u=i.next()).done);s=!0)c=u.value,r.push({value:c,id:c,source:"reference data api",first_seen:Date.now(),last_seen:Date.now()});e.next=20;break;case 16:e.prev=16,e.t0=e.catch(12),l=!0,o=e.t0;case 20:e.prev=20,e.prev=21,s||null==i.return||i.return();case 23:if(e.prev=23,!l){e.next=26;break}throw o;case 26:return e.finish(23);case 27:return e.finish(20);case 28:r=a.removeDuplicates(r),a.tableChanged("new",r),a.updateMetaData(n);case 31:a.props.displayLoadingModal(!1);case 32:case"end":return e.stop()}}),e,null,[[12,16,20,28],[21,,23,27]])})));return function(t){return e.apply(this,arguments)}}(),a.exportItems=function(){return a.download(a.props.name,a.state.allEntries)},a.removeDuplicates=function(e){return e.filter((function(e,t,a){return t===a.findIndex((function(t){return t.value===e.value}))}))},a.parseResponseData=function(e){var t=[];return e.number_of_elements>0&&e.data.forEach((function(e){void 0!==e.value&&(e.id=e.value,t.push(e))})),t},a.testValue=function(e,t,a){if(!e.value)return!1;return a?e.value.match(t):e.value.toLowerCase().includes(t.toLowerCase())},a}return Object(y.a)(t,e),t}(zt),Vt=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(b.a)(this,Object(v.a)(t).call(this,e,"map"))).addItem=function(){var e=Object(m.a)(p.a.mark((function e(t){var n,r,s,l,o,i,u;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.value.value&&t.key.value){e.next=2;break}return e.abrupt("return");case 2:return a.props.displayLoadingModal(!0),e.next=5,a.defaultEntryComment();case 5:return n=e.sent,r=[t.key.value,t.value.value,t.source.value||n],s=r[0],l=r[1],o=r[2],e.next=9,re(a.props.type,a.props.name,{key:s,value:l,source:o});case 9:(i=e.sent).error?a.props.showError(i.message):((u=a.state.allEntries).push({key:s,value:l,source:o,id:s,first_seen:Date.now(),last_seen:Date.now()}),a.tableChanged("new",u),a.updateMetaData(i)),a.props.displayLoadingModal(!1);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.deleteItem=function(){var e=Object(m.a)(p.a.mark((function e(t){var n,r,s,l,o,i,u,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.length){e.next=2;break}return e.abrupt("return");case 2:a.props.displayLoadingModal(!0),r=a.state.allEntries,s=!0,l=!1,o=void 0,e.prev=7,i=p.a.mark((function e(){var t,s,l;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.value,s=t.id,l=r.findIndex((function(e){return e.key===s})),e.next=5,le(a.props.type,a.props.name,s,{value:r[l].value});case 5:(n=e.sent).error?a.props.showError(n.message):r.splice(l,1);case 7:case"end":return e.stop()}}),e)})),u=t[Symbol.iterator]();case 10:if(s=(c=u.next()).done){e.next=15;break}return e.delegateYield(i(),"t0",12);case 12:s=!0,e.next=10;break;case 15:e.next=21;break;case 17:e.prev=17,e.t1=e.catch(7),l=!0,o=e.t1;case 21:e.prev=21,e.prev=22,s||null==u.return||u.return();case 24:if(e.prev=24,!l){e.next=27;break}throw o;case 27:return e.finish(24);case 28:return e.finish(21);case 29:n.error?a.props.showError(n.message):(a.tableChanged("new",r),a.updateMetaData(n)),a.props.displayLoadingModal(!1);case 31:case"end":return e.stop()}}),e,null,[[7,17,21,29],[22,,24,28]])})));return function(t){return e.apply(this,arguments)}}(),a.importItems=function(){var e=Object(m.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=new FileReader).onloadend=function(){var e=he(n.result,t.bulkAddSeparator.value);t.containsHeaders.value&&(e=e.slice(1));var r={},s=!0,l=!1,o=void 0;try{for(var i,u=e[Symbol.iterator]();!(s=(i=u.next()).done);s=!0){var d=i.value,p=Object(c.a)(d,2),m=p[0],f=p[1];r[m]=f}}catch(h){l=!0,o=h}finally{try{s||null==u.return||u.return()}finally{if(l)throw o}}a.bulkAdd(r)},t.file&&t.file.value&&n.readAsText(t.file.value);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.bulkAddItems=function(){var e=Object(m.a)(p.a.mark((function e(t){var n,r,s,l,o,i,u,d,m,f,h,b;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=t.bulkAddData.value.split(/\r?\n/g).map((function(e){return e.trim()})).filter((function(e){return e})),r={},s=!0,l=!1,o=void 0,e.prev=5,i=n[Symbol.iterator]();!(s=(u=i.next()).done);s=!0)d=u.value,m=d.split(t.bulkAddSeparator.value).map((function(e){return e.trim()})).filter((function(e){return e})),f=Object(c.a)(m,2),h=f[0],b=f[1],r[h]=b;e.next=13;break;case 9:e.prev=9,e.t0=e.catch(5),l=!0,o=e.t0;case 13:e.prev=13,e.prev=14,s||null==i.return||i.return();case 16:if(e.prev=16,!l){e.next=19;break}throw o;case 19:return e.finish(16);case 20:return e.finish(13);case 21:a.bulkAdd(r);case 22:case"end":return e.stop()}}),e,null,[[5,9,13,21],[14,,16,20]])})));return function(t){return e.apply(this,arguments)}}(),a.bulkAdd=function(){var e=Object(m.a)(p.a.mark((function e(t){var n,r,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.props.displayLoadingModal(!0),e.next=3,me(a.props.type,a.props.name,t);case 3:if((n=e.sent).error)a.props.showError(n.message);else{for(s in r=a.state.allEntries,t)r.push({key:s,value:t[s],id:s,source:"reference data api",first_seen:Date.now(),last_seen:Date.now()});r=a.removeDuplicates(r),a.tableChanged("new",r),a.updateMetaData(n)}a.props.displayLoadingModal(!1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.exportItems=function(){return a.download(a.props.name,a.state.allEntries,!0)},a.removeDuplicates=function(e){return e.reverse().filter((function(e,t,a){return t===a.findIndex((function(t){return t.key===e.key}))})).reverse()},a.parseResponseData=function(e){var t=[];if(e.number_of_elements>0){for(var a in e.data)void 0!==a&&t.push(Object(S.a)({key:a},e.data[a],{id:a}));return t}},a.testValue=function(e,t,a){if(!e.value||!e.key)return!1;return a?e.value.match(t)||e.key.match(t):e.value.toLowerCase().includes(t.toLowerCase())||e.key.toLowerCase().includes(t.toLowerCase())},a}return Object(y.a)(t,e),t}(zt),Kt=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(b.a)(this,Object(v.a)(t).call(this,e,"map_of_sets"))).addItem=function(){var e=Object(m.a)(p.a.mark((function e(t){var n,r,s,l,o,i,c,d,m,f,h,b;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.keyAddDataValues.value.replace(/\r?\n/g,t.keyAddSeparator.value).split(t.keyAddSeparator.value).map((function(e){return e.trim()})).filter((function(e){return e})),0!==(n=Object(u.a)(new Set(n))).length){e.next=4;break}return e.abrupt("return");case 4:return r=t.keyAddDataKey.value,s=Object(E.a)({},r,n),a.props.displayLoadingModal(!0),e.next=9,me(a.props.type,a.props.name,s);case 9:if(!(l=e.sent).error){e.next=14;break}a.props.showError(l.message),e.next=43;break;case 14:if(o=a.state.allEntries,-1!==(i=o.findIndex((function(e){return e.key===r})))){e.next=21;break}n=n.map((function(e){return{key:r,value:e,id:e,source:"reference data api"}})),o.push({key:r,values:n,id:r}),e.next=41;break;case 21:for(c=!0,d=!1,m=void 0,e.prev=24,f=function(){var e=b.value;-1===o[i].values.findIndex((function(t){return t.value===e}))&&o[i].values.push({key:r,value:e,id:e,source:"reference data api"})},h=n[Symbol.iterator]();!(c=(b=h.next()).done);c=!0)f();e.next=33;break;case 29:e.prev=29,e.t0=e.catch(24),d=!0,m=e.t0;case 33:e.prev=33,e.prev=34,c||null==h.return||h.return();case 36:if(e.prev=36,!d){e.next=39;break}throw m;case 39:return e.finish(36);case 40:return e.finish(33);case 41:a.tableChanged("new",o),a.updateMetaData(l);case 43:a.props.displayLoadingModal(!1);case 44:case"end":return e.stop()}}),e,null,[[24,29,33,41],[34,,36,40]])})));return function(t){return e.apply(this,arguments)}}(),a.deleteItem=function(){var e=Object(m.a)(p.a.mark((function e(t){var n,r,s,l,o,i,u,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.length){e.next=2;break}return e.abrupt("return");case 2:a.props.displayLoadingModal(!0),r=a.state.allEntries,s=!0,l=!1,o=void 0,e.prev=7,i=p.a.mark((function e(){var t,s,l,o,i,u,d,m,f;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=c.value,s=t.id,l=r.findIndex((function(e){return e.key===s})),o=!0,i=!1,u=void 0,e.prev=6,d=r[l].values[Symbol.iterator]();case 8:if(o=(m=d.next()).done){e.next=17;break}return f=m.value,e.next=12,le(a.props.type,a.props.name,s,{value:f.value});case 12:(n=e.sent).error&&a.props.showError(n.message);case 14:o=!0,e.next=8;break;case 17:e.next=23;break;case 19:e.prev=19,e.t0=e.catch(6),i=!0,u=e.t0;case 23:e.prev=23,e.prev=24,o||null==d.return||d.return();case 26:if(e.prev=26,!i){e.next=29;break}throw u;case 29:return e.finish(26);case 30:return e.finish(23);case 31:r.splice(l,1);case 32:case"end":return e.stop()}}),e,null,[[6,19,23,31],[24,,26,30]])})),u=t[Symbol.iterator]();case 10:if(s=(c=u.next()).done){e.next=15;break}return e.delegateYield(i(),"t0",12);case 12:s=!0,e.next=10;break;case 15:e.next=21;break;case 17:e.prev=17,e.t1=e.catch(7),l=!0,o=e.t1;case 21:e.prev=21,e.prev=22,s||null==u.return||u.return();case 24:if(e.prev=24,!l){e.next=27;break}throw o;case 27:return e.finish(24);case 28:return e.finish(21);case 29:n.error?a.props.showError(n.message):(a.tableChanged("new",r),a.updateMetaData(n)),a.props.displayLoadingModal(!1);case 31:case"end":return e.stop()}}),e,null,[[7,17,21,29],[22,,24,28]])})));return function(t){return e.apply(this,arguments)}}(),a.addInnerItem=function(){var e=Object(m.a)(p.a.mark((function e(t,n){var r,s,l,o,i,u,c,d;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.defaultEntryComment();case 2:if(r=e.sent,s=[n.value.value,t.key,n.source.value||r],l=s[0],o=s[1],i=s[2],u=a.state.allEntries.findIndex((function(e){return e.key===o})),-1===a.state.allEntries[u].values.findIndex((function(e){return e.value===e}))){e.next=8;break}return a.props.showError("Value already in table."),e.abrupt("return");case 8:return a.props.displayLoadingModal(!0),e.next=11,re(a.props.type,a.props.name,{value:l,key:o,source:i});case 11:(c=e.sent).error?a.props.showError(c.message):((d=a.state.allEntries)[u].values.push({value:l,key:o,source:i,id:l,first_seen:Date.now(),last_seen:Date.now()}),a.tableChanged("new",d),a.updateMetaData(c)),a.props.displayLoadingModal(!1);case 14:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),a.deleteInnerItem=function(){var e=Object(m.a)(p.a.mark((function e(t,n){var r,s,l,o,i,u,c,d;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&n.length){e.next=2;break}return e.abrupt("return");case 2:a.props.displayLoadingModal(!0),s=a.state.allEntries,l=!0,o=!1,i=void 0,e.prev=7,u=p.a.mark((function e(){var n,l,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=d.value,l=n.id,o=s.findIndex((function(e){return e.key===t})),e.next=5,le(a.props.type,a.props.name,t,{value:l});case 5:(r=e.sent).error?a.props.showError(r.message):s[o].values=s[o].values.filter((function(e){return e.value!==l})),0===s[o].values.length&&s.splice(o,1);case 8:case"end":return e.stop()}}),e)})),c=n[Symbol.iterator]();case 10:if(l=(d=c.next()).done){e.next=15;break}return e.delegateYield(u(),"t0",12);case 12:l=!0,e.next=10;break;case 15:e.next=21;break;case 17:e.prev=17,e.t1=e.catch(7),o=!0,i=e.t1;case 21:e.prev=21,e.prev=22,l||null==c.return||c.return();case 24:if(e.prev=24,!o){e.next=27;break}throw i;case 27:return e.finish(24);case 28:return e.finish(21);case 29:r.error?a.props.showError(r.message):(a.tableChanged("new",s),a.updateMetaData(r)),a.props.displayLoadingModal(!1);case 31:case"end":return e.stop()}}),e,null,[[7,17,21,29],[22,,24,28]])})));return function(t,a){return e.apply(this,arguments)}}(),a.importItems=function(){var e=Object(m.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=new FileReader).onloadend=function(){var e=he(n.result,t.bulkAddSeparator.value);t.containsHeaders.value&&(e=e.slice(1));var r={},s=!0,l=!1,o=void 0;try{for(var i,u=e[Symbol.iterator]();!(s=(i=u.next()).done);s=!0){var d=i.value,p=Object(c.a)(d,2),m=p[0],f=p[1];r.hasOwnProperty(m)||(r[m]=[]),r[m].push(f.trim())}}catch(h){l=!0,o=h}finally{try{s||null==u.return||u.return()}finally{if(l)throw o}}a.bulkAdd(r)},t.file&&t.file.value&&n.readAsText(t.file.value);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.exportItems=function(){var e=[],t=!0,n=!1,r=void 0;try{for(var s,l=a.state.allEntries[Symbol.iterator]();!(t=(s=l.next()).done);t=!0){var o=s.value;e.push.apply(e,Object(u.a)(o.values))}}catch(i){n=!0,r=i}finally{try{t||null==l.return||l.return()}finally{if(n)throw r}}a.download(a.props.name,e,!0,!1)},a.bulkAddItems=function(){var e=Object(m.a)(p.a.mark((function e(t){var n,r,s,l,o,i,u,d,m,f,h,b;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=t.bulkAddData.value.split(/\r?\n/g).map((function(e){return e.trim()})).filter((function(e){return e})),r={},s=!0,l=!1,o=void 0,e.prev=5,i=n[Symbol.iterator]();!(s=(u=i.next()).done);s=!0)d=u.value,m=d.split(t.bulkAddSeparator.value).map((function(e){return e.trim()})).filter((function(e){return e})),f=Object(c.a)(m,2),h=f[0],b=f[1],r.hasOwnProperty(h)||(r[h]=[]),r[h].push(b);e.next=13;break;case 9:e.prev=9,e.t0=e.catch(5),l=!0,o=e.t0;case 13:e.prev=13,e.prev=14,s||null==i.return||i.return();case 16:if(e.prev=16,!l){e.next=19;break}throw o;case 19:return e.finish(16);case 20:return e.finish(13);case 21:a.bulkAdd(r);case 22:case"end":return e.stop()}}),e,null,[[5,9,13,21],[14,,16,20]])})));return function(t){return e.apply(this,arguments)}}(),a.bulkAdd=function(){var e=Object(m.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.props.displayLoadingModal(!0),e.next=3,me(a.props.type,a.props.name,t);case 3:return(n=e.sent).error?a.props.showError(n.message):a.updateMetaData(n),e.next=7,a.loadData(a.props.type,!0);case 7:a.props.displayLoadingModal(!1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.parseResponseData=function(e){var t=[];if(e.number_of_elements>0){var a=function(t){e.data[t]=e.data[t].map((function(e){return Object(S.a)({key:t,id:e.value},e)}))};for(var n in e.data)a(n);t=Object.keys(e.data).map((function(t){return{key:t,values:e.data[t],valueLabel:e.value_label,id:t}}))}return t},a.testValue=function(e,t,a){try{if(a?e.key.match(t):e.key.toLowerCase().includes(t.toLowerCase()))return!0;var n=!0,r=!1,s=void 0;try{for(var l,o=e.values[Symbol.iterator]();!(n=(l=o.next()).done);n=!0){var i=l.value;if(a?i.value.match(t):i.value.toLowerCase().includes(t.toLowerCase()))return!0}}catch(u){r=!0,s=u}finally{try{n||null==o.return||o.return()}finally{if(r)throw s}}}catch(Qt){return!1}return!1},a}return Object(y.a)(t,e),t}(zt),Pt=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(b.a)(this,Object(v.a)(t).call(this,e,"table"))).clickAddItem=function(){var e={};if(a.state.metaData)for(var t in a.state.metaData.key_name_types)e[t]={label:t,value:"",type:"text",element_type:a.state.metaData.key_name_types[t]};var n=Object(S.a)({outer_key:{label:a.state.metaData.key_label||"Key",value:"",type:"text"}},e,{source:{label:"Comment",value:"",type:"text",help:"Optional: A comment to add to the new data entry"}});a.setState({showInputModal:!0,modalSave:a.addItem,modalInputDefinition:n})},a.addItem=function(){var e=Object(m.a)(p.a.mark((function e(t){var n,r,s,l,o,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.state.allEntries,s=[t.outer_key.value,t.source.value],o=s[1],l=s[0]){e.next=4;break}return e.abrupt("return");case 4:a.props.displayLoadingModal(!0),-1===r.findIndex((function(e){return e.key===l}))&&r.push({key:l,values:[],id:l}),a.tableChanged("new",r),delete t.outer_key,delete t.source,e.t0=p.a.keys(t);case 11:if((e.t1=e.t0()).done){e.next=20;break}if(i=e.t1.value,t[i].value){e.next=15;break}return e.abrupt("continue",11);case 15:return e.next=17,a.addInnerItem({key:l},{key:{value:i},value:{value:t[i].value},source:{value:o}},!0);case 17:n=e.sent,e.next=11;break;case 20:a.updateMetaData(n),a.props.displayLoadingModal(!1);case 22:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.deleteItem=function(){var e=Object(m.a)(p.a.mark((function e(t){var n,r,s,l,o,i,u,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.length){e.next=2;break}return e.abrupt("return");case 2:a.props.displayLoadingModal(!0),r=a.state.allEntries,s=!0,l=!1,o=void 0,e.prev=7,i=p.a.mark((function e(){var t,s,l,o,i,u,d,m,f;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=c.value,s=t.id,l=r.findIndex((function(e){return e.key===s})),o=!0,i=!1,u=void 0,e.prev=6,d=p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=f.value,e.next=3,de(a.props.type,a.props.name,s,t.key,{value:t.value});case 3:(n=e.sent).error?a.props.showError(n.message):r[l].values=r[l].values.filter((function(e){return e.key!==t.key}));case 5:case"end":return e.stop()}}),e)})),m=r[l].values[Symbol.iterator]();case 9:if(o=(f=m.next()).done){e.next=14;break}return e.delegateYield(d(),"t0",11);case 11:o=!0,e.next=9;break;case 14:e.next=20;break;case 16:e.prev=16,e.t1=e.catch(6),i=!0,u=e.t1;case 20:e.prev=20,e.prev=21,o||null==m.return||m.return();case 23:if(e.prev=23,!i){e.next=26;break}throw u;case 26:return e.finish(23);case 27:return e.finish(20);case 28:0===r[l].values.length&&r.splice(l,1);case 29:case"end":return e.stop()}}),e,null,[[6,16,20,28],[21,,23,27]])})),u=t[Symbol.iterator]();case 10:if(s=(c=u.next()).done){e.next=15;break}return e.delegateYield(i(),"t0",12);case 12:s=!0,e.next=10;break;case 15:e.next=21;break;case 17:e.prev=17,e.t1=e.catch(7),l=!0,o=e.t1;case 21:e.prev=21,e.prev=22,s||null==u.return||u.return();case 24:if(e.prev=24,!l){e.next=27;break}throw o;case 27:return e.finish(24);case 28:return e.finish(21);case 29:n.error?a.props.showError(n.message):(a.tableChanged("new",r),a.updateMetaData(n)),a.props.displayLoadingModal(!1);case 31:case"end":return e.stop()}}),e,null,[[7,17,21,29],[22,,24,28]])})));return function(t){return e.apply(this,arguments)}}(),a.addInnerItem=function(){var e=Object(m.a)(p.a.mark((function e(t,n,r){var s,l,o,i,u,c,d,m,f,h,b;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.defaultEntryComment();case 2:if(s=e.sent,l=[t.key,n.key.value,n.value.value,n.source.value||s],o=l[0],i=l[1],u=l[2],c=l[3],d=a.state.allEntries,o&&i&&u){e.next=7;break}return e.abrupt("return");case 7:return a.props.displayLoadingModal(!0),e.next=10,re(a.props.type,a.props.name,{outer_key:o,inner_key:i,value:u,source:c});case 10:if((m=e.sent).error?a.props.showError(m.message):(f=d.findIndex((function(e){return e.key===o})),h=d[f].values.findIndex((function(e){return e.key===i})),b={outer_key:o,key:i,value:u,source:c,id:i,first_seen:Date.now(),last_seen:Date.now()},-1===h?d[f].values.push(b):d[h].values[h]=b,a.updateMetaData(m),a.tableChanged("new",d)),!r){e.next=16;break}return e.abrupt("return",m);case 16:a.props.displayLoadingModal(!1);case 17:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),a.deleteInnerItem=function(){var e=Object(m.a)(p.a.mark((function e(t,n){var r,s,l,o,i,u,c,d;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&n.length){e.next=2;break}return e.abrupt("return");case 2:a.props.displayLoadingModal(!0),s=a.state.allEntries,l=!0,o=!1,i=void 0,e.prev=7,u=p.a.mark((function e(){var n,l,o,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=d.value,l=n.id,o=s.findIndex((function(e){return e.key===t})),i=s[o].values.findIndex((function(e){return e.key===l})),e.next=6,de(a.props.type,a.props.name,t,l,{value:s[o].values[i].value});case 6:(r=e.sent).error?a.props.showError(r.message):s[o].values.splice(i,1),0===s[o].values.length&&s.splice(o,1);case 9:case"end":return e.stop()}}),e)})),c=n[Symbol.iterator]();case 10:if(l=(d=c.next()).done){e.next=15;break}return e.delegateYield(u(),"t0",12);case 12:l=!0,e.next=10;break;case 15:e.next=21;break;case 17:e.prev=17,e.t1=e.catch(7),o=!0,i=e.t1;case 21:e.prev=21,e.prev=22,l||null==c.return||c.return();case 24:if(e.prev=24,!o){e.next=27;break}throw i;case 27:return e.finish(24);case 28:return e.finish(21);case 29:r.error?a.props.showError(r.message):(a.tableChanged("new",s),a.updateMetaData(r)),a.props.displayLoadingModal(!1);case 31:case"end":return e.stop()}}),e,null,[[7,17,21,29],[22,,24,28]])})));return function(t,a){return e.apply(this,arguments)}}(),a.importItems=function(){var e=Object(m.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=new FileReader).onloadend=function(){var e=he(n.result,t.bulkAddSeparator.value);t.containsHeaders.value&&(e=e.slice(1));var r={},s=!0,l=!1,o=void 0;try{for(var i,u=e[Symbol.iterator]();!(s=(i=u.next()).done);s=!0){var d=i.value,p=Object(c.a)(d,3),m=p[0],f=p[1],h=p[2];r.hasOwnProperty(m)||(r[m]={}),r[m][f]=h}}catch(b){l=!0,o=b}finally{try{s||null==u.return||u.return()}finally{if(l)throw o}}a.bulkAdd(r)},t.file&&t.file.value&&n.readAsText(t.file.value);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.exportItems=function(){var e=[],t=!0,n=!1,r=void 0;try{for(var s,l=a.state.allEntries[Symbol.iterator]();!(t=(s=l.next()).done);t=!0){var o=s.value;e.push.apply(e,Object(u.a)(o.values))}}catch(i){n=!0,r=i}finally{try{t||null==l.return||l.return()}finally{if(n)throw r}}a.download(a.props.name,e,!0,!0)},a.bulkAddItems=function(){var e=Object(m.a)(p.a.mark((function e(t){var n,r,s,l,o,i,u,d,m,f,h,b,v;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=t.bulkAddData.value.split(/\r?\n/g).map((function(e){return e.trim()})).filter((function(e){return e})),r={},s=!0,l=!1,o=void 0,e.prev=5,i=n[Symbol.iterator]();!(s=(u=i.next()).done);s=!0)d=u.value,m=d.split(t.bulkAddSeparator.value).map((function(e){return e.trim()})).filter((function(e){return e})),f=Object(c.a)(m,3),h=f[0],b=f[1],v=f[2],r.hasOwnProperty(h)||(r[h]={}),r[h][b]=v;e.next=13;break;case 9:e.prev=9,e.t0=e.catch(5),l=!0,o=e.t0;case 13:e.prev=13,e.prev=14,s||null==i.return||i.return();case 16:if(e.prev=16,!l){e.next=19;break}throw o;case 19:return e.finish(16);case 20:return e.finish(13);case 21:a.bulkAdd(r);case 22:case"end":return e.stop()}}),e,null,[[5,9,13,21],[14,,16,20]])})));return function(t){return e.apply(this,arguments)}}(),a.bulkAdd=function(){var e=Object(m.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.props.displayLoadingModal(!0),e.next=3,me(a.props.type,a.props.name,t);case 3:return(n=e.sent).error?a.props.showError(n.message):a.updateMetaData(n),e.next=7,a.loadData(a.props.type,!0);case 7:a.props.displayLoadingModal(!1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.parseResponseData=function(e){var t=[];if(e.number_of_elements>0){for(var a in e.data)for(var n in e.data[a])e.data[a][n]=Object(S.a)({outer_key:a,key:n,id:n},e.data[a][n]);t=Object.keys(e.data).map((function(t){return{key:t,values:Object.values(e.data[t]),id:t}}))}return t},a.testValue=function(e,t,a){try{if(a?e.key.match(t):e.key.toLowerCase().includes(t.toLowerCase()))return!0;var n=!0,r=!1,s=void 0;try{for(var l,o=e.values[Symbol.iterator]();!(n=(l=o.next()).done);n=!0){var i=l.value;if(a?i.value.match(t):i.value.toLowerCase().includes(t.toLowerCase()))return!0}}catch(u){r=!0,s=u}finally{try{n||null==o.return||o.return()}finally{if(r)throw s}}}catch(Qt){return!1}return!1},a}return Object(y.a)(t,e),t}(zt),Bt=a(221),Ht=a(222),qt=a(226);function Ut(e){var t={};Object.keys(e.values).forEach((function(a){t[a]=e.values[a]}));var a=Object(s.useState)(2),n=Object(c.a)(a,2),r=n[0],o=n[1],i=Object(s.useState)(t),u=Object(c.a)(i,2),d=u[0],p=u[1];return l.a.createElement("div",{className:"inner-keys"},Object.keys(d).map((function(t){return l.a.createElement("div",{className:"input-group",key:t},l.a.createElement(qt.a,{items:e.options,selectedItem:d[t].type,onChange:function(a){return function(t,a,n){var r=t.selectedItem;p(Object(S.a)({},d,Object(E.a)({},a,Object(E.a)({},n,r)))),e.values[a][n]=r}(a,t,"type")}}),l.a.createElement(At.a,{key:t,value:d[t].label,onChange:function(a){return function(t,a,n){var r=t.target.value;p(Object(S.a)({},d,Object(E.a)({},a,Object(E.a)({},n,r)))),e.values[a][n]=r}(a,t,"label")}}),l.a.createElement(D.a,{kind:"danger",size:"small",hasIconOnly:!0,renderIcon:Ye.a,iconDescription:"Delete",tooltipPosition:"bottom",className:"delete-inner-key",onClick:function(a){return delete d[n=t],p(Object(S.a)({},d)),void delete e.values[n];var n}}))})),l.a.createElement(D.a,{kind:"tertiary",size:"small",onClick:function(t){return function(t){var a="Inner Key "+r;p(Object(S.a)({},d,Object(E.a)({},a,{label:a,type:"ALN"}))),o(r+1),e.values[a]={label:a,type:"ALN"}}()}},L.t("data.new.add.key.inner")))}function Wt(e){var t=Object(s.useState)(),a=Object(c.a)(t,2),n=a[0],r=a[1],o=Object(s.useState)("days"),i=Object(c.a)(o,2),u=i[0],d=i[1];return l.a.createElement("div",{className:"inner-keys"},l.a.createElement("div",{className:"input-group"},l.a.createElement(At.a,{value:n,onChange:function(t){return function(t){var a="";t.target.value&&(a=t.target.value+" "+u),r(t.target.value),e.setValue(a)}(t)}}),l.a.createElement(qt.a,{selectedItem:u,onChange:function(t){return function(t){var a=n+" "+t.selectedItem;d(t.selectedItem),e.setValue(a)}(t)},items:e.options})))}var Gt=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(b.a)(this,Object(v.a)(t).call(this,e))).state={type:a.props.type,entries:JSON.parse(JSON.stringify(n[a.props.type]))},a.typeLookup={tables:"Table",map_of_sets:"Map of Sets",sets:"Set",maps:"Map"},a}return Object(y.a)(t,e),Object(h.a)(t,[{key:"componentDidUpdate",value:function(){this.state.type!==this.props.type&&this.setState({type:this.props.type,entries:JSON.parse(JSON.stringify(n[this.props.type]))})}},{key:"handleChange",value:function(e,t){var a=this.state.entries;a[t].value=e.target.value,this.setState({entries:a})}},{key:"handleDropdownChange",value:function(e,t){var a=this.state.entries;a[t].value=e.selectedItem,this.setState({entries:a})}},{key:"render",value:function(){var e=this;return l.a.createElement(Bt.a,null,l.a.createElement(Ht.a,{legendText:L.t("data.new.title",{type:this.typeLookup[this.state.type]})}),Object.keys(this.state.entries).map((function(t){var a;switch(e.state.entries[t].type){case"select":a=l.a.createElement(qt.a,{selectedItem:e.state.entries[t].value,onChange:function(a){return e.handleDropdownChange(a,t)},items:e.state.entries[t].options});break;case"list":a=l.a.createElement(Ut,{options:e.state.entries[t].options,label:e.state.entries[t].label,values:e.state.entries[t].values});break;case"date":a=l.a.createElement(Wt,{options:e.state.entries[t].options,label:e.state.entries[t].label,setValue:function(a){return e.state.entries[t].value=a}});break;default:a=l.a.createElement(At.a,{id:t,value:e.state.entries[t].value,onChange:function(a){return e.handleChange(a,t)}})}return l.a.createElement(Ht.a,{key:t},e.state.entries[t].help?l.a.createElement(jt.a,{direction:"right",triggerText:e.state.entries[t].label},e.state.entries[t].help):l.a.createElement(Ct.a,null,e.state.entries[t].label),a)})),l.a.createElement(D.a,{kind:"primary",size:"small",onClick:function(){return e.props.save(e.state.entries)}},L.t("data.new.create")))}}]),t}(s.Component),Jt=function(e){function t(e){var a;Object(f.a)(this,t),(a=Object(b.a)(this,Object(v.a)(t).call(this,e))).menuItemClicked=function(e,t){e&&e.stopPropagation(),a.updateHash("view/"+t.key),a.setState({updated:!0})},a.createEntry=function(e,t){e.stopPropagation(),a.updateHash("create/"+t),a.setState({updated:!0})},a.entryCreated=function(){var e=Object(m.a)(p.a.mark((function e(t,n){var r,s,l,o,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.displayLoadingModal(!0),r={},t.inner_labels&&(r.outer_key_label=t.key_label.value,s=[],Object.keys(t.inner_labels.values).forEach((function(e){s.push({key_name:t.inner_labels.values[e].label,element_type:t.inner_labels.values[e].type})})),r.key_name_types=JSON.stringify(s)),e.t0=p.a.keys(t);case 4:if((e.t1=e.t0()).done){e.next=11;break}if("key_label"!==(l=e.t1.value)&&"inner_labels"!==l){e.next=8;break}return e.abrupt("continue",4);case 8:r[l]=t[l].value,e.next=4;break;case 11:return e.next=13,Z(n,r);case 13:(o=e.sent).error?a.showError(o.message):(i=n+"/"+o.name,a.state.refData[n].nodes[o.name]={label:o.name,size:0,datatype:n,key:i},a.menuItemClicked(void 0,{key:i})),a.displayLoadingModal(!1);case 16:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),a.deleteEntry=Object(m.a)(p.a.mark((function e(){var t,n,r,s,l;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Do you really want to delete this entry")){e.next=9;break}return a.displayLoadingModal(!0),t=a.parseHash(),n=Object(c.a)(t,4),n[0],n[1],r=n[2],s=n[3],l=function(e){e.error?a.showError(e.message):(a.updateHash(""),delete a.state.refData[r].nodes[s],a.setState({updated:!0})),a.displayLoadingModal(!1)},e.next=7,ue(r,s,l);case 7:e.next=10;break;case 9:return e.abrupt("return");case 10:case"end":return e.stop()}}),e)}))),a.showError=function(e){var t=a.state.errorMessages;e||(e="An unspecified error occured"),e=Array.isArray(e)?e:[e],t.push.apply(t,Object(u.a)(e)),a.setState({errorMessages:t})},a.getRefData=Object(m.a)(p.a.mark((function e(){var t,n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=a.state.refData,n=p.a.mark((function e(n){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y(n);case 2:if(!(r=e.sent).error){e.next=6;break}return a.showError("Unable to load "+t[n].label),e.abrupt("return","continue");case 6:t[n].nodes={},t[n].size=r.length,t[n].datatype=n.replace(/_/g," "),r.sort((function(e,t){return e.name.toLowerCase()>t.name.toLowerCase()?1:-1})),r.forEach((function(e){t[n].nodes[e.name]={label:e.name,size:e.number_of_elements,datatype:n,key:n+"/"+e.name}}));case 11:case"end":return e.stop()}}),e)})),e.t0=p.a.keys(t);case 3:if((e.t1=e.t0()).done){e.next=11;break}return r=e.t1.value,e.delegateYield(n(r),"t2",6);case 6:if("continue"!==e.t2){e.next=9;break}return e.abrupt("continue",3);case 9:e.next=3;break;case 11:a.setState({refData:t});case 12:case"end":return e.stop()}}),e)}))),a.parseHash=function(){var e=decodeURI(window.location.hash.substring("#/data".length)).split("/"),t=Object(c.a)(e,4),a=(t[0],t[1]),n=t[2],r=t[3];return[n+"/"+r,a,n,r]},a.updateHash=function(e){return window.location.hash="/data/"+e},a.displayLoadingModal=function(e){return a.setState({loading:e})},a.refDataMapping={maps:Vt,sets:Ft,map_of_sets:Kt,tables:Pt};var n={sets:{key:"sets",label:L.t("data.sidebar.type",{type:"Set"}),nodes:{}},maps:{key:"maps",label:L.t("data.sidebar.type",{type:"Map"}),nodes:{}},map_of_sets:{key:"map_of_sets",label:L.t("data.sidebar.type",{type:"Map of Sets"}),nodes:{}},tables:{key:"tables",label:L.t("data.sidebar.type",{type:"Table"}),nodes:{}}};return a.state={refData:n,errorMessages:[],loading:!1},a.getRefData(),a}return Object(y.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this,t="",a="",n="",r="";if(window.location.hash.includes("#/data/")){var s=this.parseHash(),o=Object(c.a)(s,4);a=o[0],n=o[1],t=o[2],r=o[3]}var i=this.refDataMapping[t];return l.a.createElement(x.a,{secondaryInitialSize:84,percentage:!0},l.a.createElement(R,{menuItemAction:this.menuItemClicked,showError:this.showError,createEntry:this.createEntry,refData:this.state.refData}),l.a.createElement("div",{id:"content"},l.a.createElement(k.a,{active:this.state.loading,withOverlay:!0}),this.state.errorMessages.length>0&&l.a.createElement(w.a,{kind:"error",className:"error-alert",onCloseButtonClick:function(t){e.setState({errorMessages:[]})},title:"Error"},this.state.errorMessages.map((function(e){return l.a.createElement("span",{key:e,className:"error-alert-message"},e,l.a.createElement("br",null))}))),"create"===n?l.a.createElement(Gt,{type:t,save:function(a){return e.entryCreated(a,t)}}):i&&l.a.createElement(i,{key:a,api:a,name:r,type:t,deleteEntry:this.deleteEntry,dataUpdated:this.getRefData,displayLoadingModal:this.displayLoadingModal,showError:this.showError})))}}]),t}(s.Component);a(198);i.a.render(l.a.createElement(Jt,null),document.getElementById("root"))}},[[123,1,2]]]);
//# sourceMappingURL=main.5c7563a1.chunk.js.map