(this["webpackJsonpref-data-management"]=this["webpackJsonpref-data-management"]||[]).push([[0],{129:function(e,t,a){e.exports=a(212)},134:function(e,t,a){},139:function(e,t,a){},212:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"sets",(function(){return Ee})),a.d(n,"maps",(function(){return xe})),a.d(n,"map_of_sets",(function(){return Ie})),a.d(n,"tables",(function(){return Se})),a.d(n,"setAddItem",(function(){return Oe})),a.d(n,"setBulkAddItems",(function(){return _e})),a.d(n,"setImportItems",(function(){return je})),a.d(n,"mapAddItem",(function(){return De})),a.d(n,"mapBulkAddItems",(function(){return Te})),a.d(n,"mapImportItems",(function(){return Ce})),a.d(n,"map_of_setsAddItem",(function(){return Ae})),a.d(n,"map_of_setsAddInnerItem",(function(){return Me})),a.d(n,"map_of_setsImportItems",(function(){return Le})),a.d(n,"map_of_setsBulkAddItems",(function(){return Re})),a.d(n,"tableAddItem",(function(){return Ne})),a.d(n,"tableAddInnerItem",(function(){return ze})),a.d(n,"tableImportItems",(function(){return Fe})),a.d(n,"tableBulkAddItems",(function(){return Ve}));var r,s=a(0),l=a.n(s),o=a(58),c=a.n(o),u=(a(134),a(21)),i=a(8),d=a(3),p=a.n(d),m=a(6),f=a(12),h=a(22),b=a(13),v=a(14),y=a(236),k=a(237),g=a(119),w=a.n(g),E=(a(138),a(139),a(10)),x=a(16),I=a(214),S=a(221),O=a(213),_=a(222),j=a(223),D=a(224),T=a(225),C=a(87),A=a(120);C.a.use(A.a).init({resources:{en:{translations:{"data.search.all.input":"Search value in all Reference Sets","data.search.all.no.results":"Value not found in any Reference Set","data.search.all.table.title":"Contained in","data.search.all.placeholder":"Search","data.search.all.button":"Search","data.sidebar.search":"Search","data.sidebar.search.all":"Search All Sets","data.sidebar.create":"Create New","data.sidebar.type":"Reference $t({{type}})","data.table.elements.delete.set":"Delete Set","data.table.elements.delete.map":"Delete Map","data.table.elements.delete.map_of_sets":"Delete Map of Sets","data.table.elements.delete.table":"Delete Table","data.table.elements.add":"Add Entry","data.table.elements.bulk":"Bulk Add","data.table.elements.import":"Import from File","data.table.elements.export":"Export to File","data.table.elements.delete":"Delete","data.meta.elements.purge":"Clear Data","data.meta.elements.count":"Number of Elements","data.meta.elements.creation":"Creation Time","data.meta.elements.type.value":"Default Value Type","data.meta.elements.types.value":"Default Value Types","data.meta.elements.type.key":"Key Type","data.meta.elements.types.key":"Key Types","data.meta.elements.ttl":"Time To Live","data.meta.elements.ttl.forever":"Forever","data.meta.elements.timeout":"Timeout Type","data.dependents.title":"Dependents","data.dependents.none":"This ReferenceData appears to not have any data depending on it","carbon.table.pagination.items.per.page":"Items per page","carbon.table.pagination.pages.total":"of {{total}} pages ","carbon.table.pagination.items.total":"{{min}}\u2013{{max}} of {{total}} items","carbon.table.batch.cancel":"Cancel","carbon.table.batch.items.selected":"{{totalSelected}} items selected","carbon.table.batch.item.selected":"{{totalSelected}} item selected","carbon.table.toolbar.search.label":"Filter table","carbon.table.toolbar.search.placeholder":"Filter table","data.new.title":"Add new Reference {{type}} to Database","data.new.create":"Create","data.new.add.key.inner":"Add Inner Key","data.new.elementtype":"Element Type","data.new.timeout":"Timeout Type","data.new.ttl":"Time to Live","data.new.name":"Reference $t({{name}}) Name","data.new.name.help":"Required: The name of the $t({{name}}) to be created. Must not exist already","data.new.key":"Key Label","data.new.key.type":"Default Key Type","data.new.key.outer":"Outer Key Label","data.new.value":"Value Label","data.table.elements.add.separator.help":"New lines are implicit separators","data.table.elements.add.source.help":"Optional: A comment to add to the new data entry","data.table.elements.add.title":"Add Entry","data.table.elements.add.entries":"Entries","data.table.elements.add.save":"Save","data.table.elements.add.close":"Close","data.table.elements.add.file":"File","data.table.elements.add.file.placeholder":"Drag and drop file here or click to upload","data.table.elements.add.source":"Source",Set:"Set",Map:"Map","Map of Sets":"Map of Sets",Table:"Table","data.table.elements.file.separator.help":"Individual set values need to be separated by new lines"}},e:{translations:(r={"data.search.all.input":"Alle Eintr\xe4ge durchsuchen","data.search.all.no.results":"Keinen passenden Eintrag gefunden","data.search.all.table.title":"Gefunden in","data.search.all.placeholder":"Suchen","data.search.all.button":"Suchen","data.sidebar.search":"Suchen","data.sidebar.search.all":"Alle durchsuchen","data.sidebar.create":"Hinzuf\xfcgen","data.sidebar.type":"Referenz $t({{type}})","data.table.elements.delete.set":"Set l\xf6schen","data.table.elements.delete.map":"Zuordnung l\xf6schen","data.table.elements.delete.map_of_sets":"Zuordnung von Gruppen l\xf6schen","data.table.elements.delete.table":"Tabelle l\xf6schen","data.table.elements.add":"Eintrag hinzuf\xfcgen","data.table.elements.bulk":"Mehrere hinzuf\xfcgen","data.table.elements.import":"Datei importieren","data.table.elements.export":"Exportieren","data.table.elements.delete":"L\xf6schen","data.meta.elements.purge":"Daten l\xf6schen","data.meta.elements.count":"Anzahl Elemente","data.meta.elements.creation":"Erstelldatum","data.meta.elements.type.value":"Werttyp","data.meta.elements.types.value":"Werttypen","data.meta.elements.type.key":"Schl\xfcsseltyp","data.meta.elements.types.key":"Schl\xfcsseltypen","data.meta.elements.ttl":"Ablaufzeitraum","data.meta.elements.ttl.forever":"Nie","data.meta.elements.timeout":"Ablauftyp","data.dependents.title":"Abh\xe4ngigkeiten","data.dependents.none":"F\xfcr diesen Eintrag scheint es keine Abh\xe4ngigkeiten zu geben","carbon.table.pagination.items.per.page":"Elemente pro Seite","carbon.table.pagination.pages.total":"von {{total}} Seiten","carbon.table.pagination.items.total":"{{min}}\u2013{{max}} von {{total}} Elementen","carbon.table.batch.cancel":"Abbrechen","carbon.table.batch.item.selected":"{{totalSelected}} Element ausgew\xe4hlt","carbon.table.batch.items.selected":"{{totalSelected}} Elemente ausgew\xe4hlt","carbon.table.toolbar.search.label":"Tabelle durchsuchen","carbon.table.toolbar.search.placeholder":"Tabelle durchsuchen","data.new.title":"Erstelle Referenz $t({{type}}) in Datenbank","data.new.create":"Hinzuf\xfcgen","data.new.add.key.inner":"Inneren Schl\xfcssel hinzuf\xfcgen","data.new.elementtype":"Element Typ","data.new.timeout":"Ablauftyp","data.new.ttl":"Ablaufzeitraum","data.new.name":"Name des/r Referenz $t({{name}})","data.new.name.help":"Verpflichtend: Der Name f\xfcr den zu erstellenden Referenz $t({{name}}) Eintrag. Darf noch nicht existieren","data.new.key":"Bezeichnung f\xfcr Schl\xfcssel","data.new.key.type":"Fallback Datentyp des Schl\xfcssels","data.new.key.outer":"Bezeichnung f\xfcr \xe4u\xdferen Schl\xfcssel","data.new.value":"Bezeichnung f\xfcr Wert","data.table.elements.add.title":"Eintrag hinzuf\xfcgen","data.table.elements.add.save":"Hinzuf\xfcgen","data.table.elements.add.close":"Schlie\xdfen","data.table.elements.add.separator.help":"Zeilenumbr\xfcche sind implizite Separatoren","data.table.elements.add.source":"Source","data.table.elements.add.source.help":"Optional: Kommentar f\xfcr den neuen Eintrag"},Object(E.a)(r,"data.table.elements.add.title","Eintrag hinzuf\xfcgen"),Object(E.a)(r,"data.table.elements.add.entries","Eintr\xe4ge"),Object(E.a)(r,"data.table.elements.add.file","Datei"),Object(E.a)(r,"data.table.elements.add.file.placeholder","Datei herziehen oder klicken um eine neue Datei hochzuladen"),Object(E.a)(r,"Set","Set"),Object(E.a)(r,"Map","Zuordnung"),Object(E.a)(r,"Map of Sets","Zuordnung von Gruppen"),Object(E.a)(r,"Table","Tabelle"),Object(E.a)(r,"data.table.elements.file.separator.help","Individual set values need to be separated by new lines"),r)}},fallbackLng:"en",debug:!1,ns:["translations"],defaultNS:"translations",keySeparator:!1,interpolation:{escapeValue:!1}});var M=C.a,L=a(64);var R=function(e){var t=Object(s.useState)(""),a=Object(i.a)(t,2),n=a[0],r=a[1],o=Object(s.useState)({}),c=Object(i.a)(o,2),u=c[0],d=c[1];return l.a.createElement("div",{id:"menu"},l.a.createElement(I.a,{kind:"ghost",small:!0,defaultToggled:!0,id:"switch-theme",onClick:function(){return e.updateTheme(!0)}},"Switch Theme"),l.a.createElement(S.a,{type:"text",labelText:M.t("data.sidebar.search"),placeHolderText:M.t("data.sidebar.search"),light:!0,onChange:function(e){r(e.target.value),d({sets:!0,maps:!0,map_of_sets:!0,tables:!0})},value:n}),l.a.createElement(O.a,null,Object.keys(e.refData).map((function(t){return l.a.createElement(_.a,{key:t,open:u[t],title:e.refData[t].label,className:"menu-title",onClick:function(){return function(e){d(Object(x.a)({},u,Object(E.a)({},e,!u[e])))}(t)}},l.a.createElement(I.a,{kind:"primary",size:"small",className:"btn-sidebar",onClick:function(a){return e.createEntry(a,t)},key:"btn-"+t},M.t("data.sidebar.create")),"sets"===t&&l.a.createElement(I.a,{kind:"primary",size:"small",className:"btn-sidebar",onClick:function(a){return e.searchAll(a,t)},key:"btn-search-"+t},M.t("data.sidebar.search.all")),l.a.createElement(j.a,{className:"menu-list"},void 0===e.refData[t].size?l.a.createElement(D.a,{paragraph:!0,lineCount:3,heading:!0}):Object.keys(e.refData[t].nodes).map((function(a){if(function(e){try{return e.match(new RegExp(n,"i"))}catch(t){return e.toLowerCase().includes(n.toLowerCase())}}(a)){var r=e.refData[t].nodes[a];return l.a.createElement(I.a,{kind:"ghost",size:"small",key:r.label,className:"menu-entry",onClick:function(t){return e.menuItemAction(t,r)}},r.label,l.a.createElement(T.a,{className:"menu-entry-badge"},r.size||"0"))}}))))}))))},N=a(7),z=a(121),F=a.n(z),V=a(39),K=a(122),P=a.n(K),H={apiRoot:"/api",refDataApi:"/reference_data/",rulesApi:"analytics/",ruleWizardBase:"/console/core/jsp/WizardFrame.jsp?action=edit&appName=qradar&pageId=rulewizard&ruleId=",newRuleWizardBase:"/console/core/jsp/WizardFrame.jsp?action=new&appName=qradar&pageId=rulewizard&type=",aqlSearch:"/console/qradar/jsp/ArielSearchWrapper.jsp?"+encodeURI("url=do/ariel/arielSearch?"),aqlSearchDefaults:encodeURIComponent("appName=EventViewer&pageId=EventList&dispatch=performSearch&value(searchMode)=AQL&value(timeRangeType)=aqlTime&"),aqlSearchDefaultsFlow:encodeURIComponent("appName=Surveillance&pageId=FlowList&dispatch=performSearch&value(searchMode)=AQL&value(timeRangeType)=aqlTime&"),popupSettings:"status=yes,scrollbars=yes,resizable=yes,",axiosHeaders:{"Content-Type":"text/plain",Version:"10.1"},colors:{cepForce:"#0530ad",cep:"#0062ff",lst:"#054719",bb:"#da1e28",rule:"#750e13",font:"white",fontDisabled:"lightgray",edge:"#a2b5ce",qradarBlue:"#4178be"},fontFace:'"IBM Helvetica Neue", "Helvetica Neue", Helvetica, Arial, Roboto, sans-serif'},B=function(e){return e?encodeURIComponent(encodeURIComponent(e)):void 0},q=!1,U="";try{var W=V.QRadar.getCurrentUser();W&&!W.error&&(q=!0),U=V.QRadar.getCookie(V.QRadar.QRADAR_CSRF)}catch(sa){}function G(e,t,a,n,r){return J.apply(this,arguments)}function J(){return(J=Object(m.a)(p.a.mark((function e(t,a,n,r,s){var l,o,c,u;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=F.a.create(),(o=Object.assign({},H.axiosHeaders,s||{})).Version="8",o["Allow-hidden"]="true",l.defaults.timeout=6e5,c=Math.ceil(1e3*Math.random()),console.time("".concat(c,": ").concat(t," ").concat(a)),u={data:[]},q&&(o[V.QRadar.QRADAR_CSRF]=U),e.prev=9,e.next=12,l.request({method:t,url:H.apiRoot+a+(n?"?"+P.a.stringify(n):""),data:r||{},headers:o});case 12:u=e.sent,e.next=24;break;case 15:if(e.prev=15,e.t0=e.catch(9),console.log("Failed loading data from ".concat(a)),console.timeEnd("".concat(c,": ").concat(t," ").concat(a)),e.t0.response&&e.t0.response.data){e.next=23;break}return e.abrupt("return",{error:e.t0,message:"Failed performing the requested network operation"});case 23:return e.abrupt("return",{error:e.t0,message:e.t0.response.data.message});case 24:return console.timeEnd("".concat(c,": ").concat(t," ").concat(a)),e.abrupt("return",u.data);case 26:case"end":return e.stop()}}),e,null,[[9,15]])})))).apply(this,arguments)}function Q(e,t,a,n){return Y.apply(this,arguments)}function Y(){return(Y=Object(m.a)(p.a.mark((function e(t,a,n,r){var s,l,o,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"GET","id, status, message",s=a,l=a.status,o=0,c=setInterval(Object(m.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o++,!("CANCELLED"===l||"CANCELING"===l||"EXCEPTION"===l||"CONFLICT"===l||o>50)){e.next=6;break}clearInterval(c),n({error:!0,message:s.message}),e.next=19;break;case 6:if("COMPLETED"!==l){e.next=15;break}if(clearInterval(c),!r){e.next=12;break}return e.next=11,G("GET",t+"/results",{});case 11:s=e.sent;case 12:n(s),e.next=19;break;case 15:return e.next=17,G("GET",t,{fields:"id, status, message"});case 17:s=e.sent,l=s.status;case 19:case"end":return e.stop()}}),e)}))),2e3);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(e){return $.apply(this,arguments)}function $(){return($=Object(m.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="/reference_data/".concat(t),"GET",e.next=4,G("GET",a);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function X(e,t){return ee.apply(this,arguments)}function ee(){return(ee=Object(m.a)(p.a.mark((function e(t,a){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="/reference_data/".concat(t,"/search?value=").concat(encodeURIComponent(a)),"GET",e.next=4,G("GET",n);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(e,t){return ae.apply(this,arguments)}function ae(){return(ae=Object(m.a)(p.a.mark((function e(t,a){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="/reference_data/".concat(t),"POST",e.next=4,G("POST",n,a);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ne(e,t,a){return re.apply(this,arguments)}function re(){return(re=Object(m.a)(p.a.mark((function e(t,a,n){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="/reference_data/".concat(t,"/").concat(B(a)),"GET",e.next=4,G("GET",r,void 0,void 0,n);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function se(e,t,a,n){return le.apply(this,arguments)}function le(){return(le=Object(m.a)(p.a.mark((function e(t,a,n,r){var s,l,o,c,u,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s="/reference_data/".concat(t,"/").concat(B(a),"/dependents"),l="GET",o="status, id, message",e.prev=2,a){e.next=5;break}throw new Error;case 5:return e.next=7,G(l,s,{fields:o});case 7:if((c=e.sent)&&c.id){e.next=10;break}throw new Error;case 10:if(u=c.status||"CANCELLED","maps"===t?t="map":"sets"===t&&(t="set"),i="/reference_data/".concat(t,"_dependent_tasks/").concat(c.id),!r){e.next=17;break}return e.abrupt("return",c);case 17:Q(i,u,n,!0);case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(2),n({error:e.t0,message:"Unable to load dependents"});case 23:case"end":return e.stop()}}),e,null,[[2,20]])})))).apply(this,arguments)}function oe(e,t,a){return ce.apply(this,arguments)}function ce(){return(ce=Object(m.a)(p.a.mark((function e(t,a,n){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="/reference_data/".concat(t,"/").concat(B(a)),"POST",e.next=4,G("POST",r,n);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ue(e,t,a,n){return ie.apply(this,arguments)}function ie(){return(ie=Object(m.a)(p.a.mark((function e(t,a,n,r){var s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s="/reference_data/".concat(t,"/").concat(B(a),"/").concat(B(n)),"DELETE",e.next=4,G("DELETE",s,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function de(){return(de=Object(m.a)(p.a.mark((function e(t,a,n,r){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:pe(t,a,n,!0,r);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function pe(e,t,a){return me.apply(this,arguments)}function me(){return(me=Object(m.a)(p.a.mark((function e(t,a,n){var r,s,l,o,c,u,i,d=arguments;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=d.length>3&&void 0!==d[3]&&d[3],s=d.length>4&&void 0!==d[4]&&d[4],l="/reference_data/".concat(t,"/").concat(B(a)),o="DELETE",e.prev=4,a){e.next=7;break}throw new Error;case 7:return e.next=9,G(o,l,{purge_only:r});case 9:if((c=e.sent)&&c.id){e.next=12;break}throw new Error;case 12:if(u=c.status,"maps"===t?t="map":"sets"===t&&(t="set"),i="/reference_data/".concat(t,"_delete_tasks/").concat(c.id),n&&!s){e.next=19;break}return e.abrupt("return",c);case 19:Q(i,u,n);case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(4),n({error:e.t0,message:e.t0.message||"Unable to delete Reference Data"});case 25:case"end":return e.stop()}}),e,null,[[4,22]])})))).apply(this,arguments)}function fe(e,t,a,n,r){return he.apply(this,arguments)}function he(){return(he=Object(m.a)(p.a.mark((function e(t,a,n,r,s){var l;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l="/reference_data/".concat(t,"/").concat(B(a),"/").concat(B(n),"/").concat(B(r)),"DELETE",e.next=4,G("DELETE",l,s);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function be(e,t,a){return ve.apply(this,arguments)}function ve(){return(ve=Object(m.a)(p.a.mark((function e(t,a,n){var r,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="/reference_data/".concat(t,"/bulk_load/").concat(B(a)),"POST",(s={})["Content-Type"]="application/json",e.next=6,G("POST",r,{},n,s);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ye(e,t){t=t||",";for(var a=new RegExp("(\\"+t+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+t+"\\r\\n]*))","gi"),n=[[]],r=null;r=a.exec(e);){var s=r[1];s.length&&s!==t&&n.push([]);var l=void 0;l=r[2]?r[2].replace(new RegExp('""',"g"),'"'):r[3],n[n.length-1].push(l.trim())}return n.filter((function(e){return e.some((function(e){return e}))}))}var ke=["ALN","NUM","IP","PORT","ALNIC","DATE"],ge=["FIRST_SEEN","LAST_SEEN"],we=["mons","days","hours","minutes","seconds"],Ee={name:{value:"",type:"text",label:M.t("data.new.name",{name:"Set"}),help:M.t("data.new.name.help",{name:"Set"})},element_type:{value:"ALN",type:"select",label:M.t("data.new.elementtype"),options:ke,help:"Required: The data type of the values in the new Set"},timeout_type:{value:"FIRST_SEEN",type:"select",label:M.t("data.new.timeout"),options:ge,help:"Optional: The value based on which new data expires from the Set"},time_to_live:{value:"",type:"date",options:we,label:M.t("data.new.ttl"),help:"Optional: If given, the entries of the set expire"}},xe={name:{value:"",type:"text",label:M.t("data.new.name",{name:"Map"}),help:M.t("data.new.name.help",{name:"Map"})},element_type:{value:"ALN",type:"select",label:M.t("data.new.elementtype"),options:ke,help:"Required: The data type of the values in the new Map"},timeout_type:{value:"FIRST_SEEN",type:"select",label:M.t("data.new.timeout"),options:ge,help:"Optional: The value based on which new data expires from the Map"},time_to_live:{value:"",type:"date",options:we,label:M.t("data.new.ttl"),help:"Optional: If given, the entries of the Map expire"},key_label:{value:"",label:M.t("data.new.key"),type:"text",help:"Required: The label of the keys in the new Map"},value_label:{value:"",label:M.t("data.new.value"),type:"text",help:"Required: The label of the values in the new Map"}},Ie={name:{value:"",type:"text",label:M.t("data.new.name",{name:"Map of Sets"}),help:M.t("data.new.name.help",{name:"Map of Sets"})},element_type:{value:"ALN",type:"select",label:M.t("data.new.elementtype"),options:ke,help:"Required: The data type of the values in the new Map of Sets"},timeout_type:{value:"FIRST_SEEN",type:"select",label:M.t("data.new.timeout"),options:ge,help:"Optional: The value based on which new data expires from the Map of Sets"},time_to_live:{value:"",type:"date",options:we,label:M.t("data.new.ttl"),help:"Optional: If given, the entries of the Map of Sets expire"},key_label:{value:"",label:M.t("data.new.key"),type:"text",help:"Required: The label of the keys in the new Map of Sets"},value_label:{value:"",label:M.t("data.new.value"),type:"text",help:"Required: The label of the values in the new Map of Sets"}},Se={name:{value:"",type:"text",label:M.t("data.new.name",{name:"Table"}),help:M.t("data.new.name.help",{name:"Table"})},timeout_type:{value:"FIRST_SEEN",type:"select",label:M.t("data.new.timeout"),options:ge,help:"Optional: The value based on which new data expires from the Table"},time_to_live:{value:"",type:"date",options:we,label:M.t("data.new.ttl"),help:"Optional: If given, the entries of the Table expire"},key_label:{value:M.t("data.new.key.outer"),label:M.t("data.new.key"),type:"text",help:"Required: The label of the keys in the new Table"},element_type:{value:"ALN",type:"select",label:M.t("data.new.key.type"),options:ke,help:"Required: The fallback data type of the Inner Keys in the new Table"},inner_labels:{label:"Inner Keys",options:ke,type:"list",values:{"Inner Key 1":{label:"Inner Key 1",type:"ALN"}},help:"Required: The data type of the Inner Keys in the new Table"}},Oe={value:{label:"Value",value:"",type:"text"},source:{value:"",label:M.t("data.table.elements.add.source"),type:"text",help:M.t("data.table.elements.add.source.help")}},_e={bulkAddData:{label:M.t("data.table.elements.add.entries"),value:"",type:"textarea"},bulkAddSeparator:{label:"Separator",value:",",help:M.t("data.table.elements.add.separator.help"),type:"text"}},je={file:{label:M.t("data.table.elements.add.file"),value:"",type:"file"},bulkAddSeparator:{label:"Separator",value:",",help:M.t("data.table.elements.file.separator.help"),type:"text"},containsHeaders:{label:"CSV contains headers",value:!0,help:"Whether the CSV has a headers row or not",type:"checkbox"}},De={key:{label:"Key",value:"",type:"text"},value:{label:"Value",value:"",type:"text"},source:{value:"",label:M.t("data.table.elements.add.source"),type:"text",help:M.t("data.table.elements.add.source.help")}},Te={bulkAddData:{label:M.t("data.table.elements.add.entries"),value:"",type:"textarea"},bulkAddSeparator:{label:"Key-Value Separator",value:",",type:"text",help:"Example Format: Key1,Value1\\nKey2,Value2\\nKey3,Value3, ..."}},Ce={file:{label:M.t("data.table.elements.add.file"),value:"",type:"file"},bulkAddSeparator:{label:"Key-Value Separator",value:",",type:"text",help:"Example Format: Key1,Value1\\nKey2,Value2\\nKey3,Value3, ..."},containsHeaders:{label:"CSV contains headers",value:!0,help:"Whether the CSV has a headers row (key,value,first_seen...) or not",type:"checkbox"}},Ae={keyAddDataKey:{label:"Input Key",value:"",type:"text"},keyAddDataValues:{label:"Input Values",value:"",type:"textarea"},keyAddSeparator:{label:"Separator",value:",",help:M.t("data.table.elements.add.separator.help"),type:"text"}},Me={value:{label:"Value",value:"",type:"text"},source:{value:"",label:M.t("data.table.elements.add.source"),type:"text",help:M.t("data.table.elements.add.source.help")}},Le={file:{label:M.t("data.table.elements.add.file"),value:"",type:"file"},bulkAddSeparator:{label:"Key-Value Separator",value:",",help:"Example Format: Key1,Value1\\nKey1,Value2\\nKey2,Value3, ...",type:"text"},containsHeaders:{label:"CSV contains headers",value:!0,help:"Whether the CSV has a headers row or not",type:"checkbox"}},Re={bulkAddData:{label:M.t("data.table.elements.add.entries"),value:"",type:"textarea"},bulkAddSeparator:{label:"Key-Value Separator",value:",",help:"Example Format: Key1,Value1\\nKey1,Value2\\nKey2,Value3, ...",type:"text"}},Ne={keyAddDataKey:{label:"Input Key",value:"",type:"text"},keyAddDataValues:{label:"Input Values",value:"",type:"textarea"},keyAddSeparator:{label:"Separator",value:",",help:M.t("data.table.elements.add.separator.help"),type:"text"}},ze={key:{label:"Key",value:"",type:"text"},value:{label:"Value",value:"",type:"text"},source:{value:"",label:M.t("data.table.elements.add.source"),type:"text",help:M.t("data.table.elements.add.source.help")}},Fe={file:{label:M.t("data.table.elements.add.file"),value:"",type:"file"},bulkAddSeparator:{label:"Key-Value Separator",value:",",help:"Example Format: Parent Key, Inner Key, Value\\n...",type:"text"},containsHeaders:{label:"CSV contains headers",value:!0,help:"Whether the CSV has a headers row or not",type:"checkbox"}},Ve={bulkAddData:{label:M.t("data.table.elements.add.entries"),value:"",type:"textarea"},bulkAddSeparator:{label:"Key-Value Separator",value:",",help:"Example Format: Parent Key, Inner Key, Value\\n...",type:"text"}},Ke=[{key:"value",header:"Value"},{key:"first_seen",header:"First Seen"},{key:"last_seen",header:"Last Seen"},{key:"source",header:"Source"}],Pe=[{key:"key",header:"Key"},{key:"value",header:"Value"},{key:"first_seen",header:"First Seen"},{key:"last_seen",header:"Last Seen"},{key:"source",header:"Source"}],He=[{key:"key",header:"Key"}],Be=[{key:"value",header:"Value"},{key:"first_seen",header:"First Seen"},{key:"last_seen",header:"Last Seen"},{key:"source",header:"Source"}],qe=[{key:"key",header:"Key"}],Ue=[{key:"key",header:"Inner Key"},{key:"value",header:"Value"},{key:"first_seen",header:"First Seen"},{key:"last_seen",header:"Last Seen"},{key:"source",header:"Source"}],We=a(123),Ge=a.n(We),Je=a(60),Qe=a.n(Je),Ye=a(226),Ze=a(227),$e=a(5);function Xe(e){var t,a="",n=e.split(/(\S+\s\S+)/).filter((function(e){return e.trim()})),r=Object(N.a)(n);try{for(r.s();!(t=r.n()).done;){var s=t.value;0!=s.split(/\s/)[0]&&(a+=" "+s)}}catch(l){r.e(l)}finally{r.f()}return a}var et=function(e){var t=[l.a.createElement(l.a.Fragment,null,M.t("data.meta.elements.count"),": ",l.a.createElement(T.a,{type:"gray"},e.data.number_of_elements||0)),l.a.createElement(l.a.Fragment,null,M.t("data.meta.elements.creation"),": ",e.data.creation_time?Qe()(e.data.creation_time,"dd/mmm/yyyy, hh:MM:ss TT"):""),l.a.createElement(l.a.Fragment,null,M.t("data.meta.elements.timeout"),": ",e.data.timeout_type),l.a.createElement(l.a.Fragment,null,M.t("data.meta.elements.ttl"),": ",e.data.time_to_live?Xe(e.data.time_to_live):M.t("data.meta.elements.ttl.forever")),l.a.createElement(l.a.Fragment,null,M.t("data.meta.elements.type.value"),": ",e.data.element_type)],a=e.data.key_name_types&&"";if(void 0!==a){for(var n in e.data.key_name_types)a+=n+" ("+e.data.key_name_types[n]+"), ";t.splice(4,0,l.a.createElement(l.a.Fragment,null,M.t("data.meta.elements.types.key"),": ",a))}return l.a.createElement(l.a.Fragment,null,l.a.createElement(I.a,{kind:"danger",size:"small",className:"delete top right",onClick:e.deleteEntry},M.t("data.table.elements.delete."+e.typeLabel)),l.a.createElement(I.a,{kind:"danger",size:"small",className:"delete top-second right",onClick:e.purgeData},M.t("data.meta.elements.purge")),e.data.name?l.a.createElement(Ye.e,{id:"meta-data"},l.a.createElement(Ye.c,null,l.a.createElement(Ye.d,{head:!0},l.a.createElement(Ye.b,{head:!0,className:"meta-data-title"},e.data.name,l.a.createElement(I.a,{className:"reload",onClick:e.reload,kind:"ghost",size:"small",tooltipPosition:"bottom",renderIcon:$e.r,iconDescription:"Refresh"})))),l.a.createElement(Ye.a,null,t.map((function(e,t){return l.a.createElement(Ye.d,{key:t},l.a.createElement(Ye.b,{className:"meta-data-entry"},e))})))):l.a.createElement(Ze.a,{id:"meta-data"}))},tt=a(238),at=a(83),nt=a(84),rt=a(85),st=a(240),lt=tt.a.TableContainer,ot=tt.a.Table,ct=tt.a.TableHead,ut=tt.a.TableRow,it=tt.a.TableBody,dt=tt.a.TableCell,pt=tt.a.TableHeader,mt=tt.a.TableToolbar,ft=tt.a.TableSelectAll,ht=tt.a.TableSelectRow,bt=tt.a.TableBatchActions,vt=tt.a.TableBatchAction,yt=tt.a.TableToolbarContent,kt=tt.a.TableToolbarSearch,gt=function(e){return Qe()(e,"dd/mmm/yyyy, hh:MM:ss TT")},wt=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(e){var n;Object(f.a)(this,a),(n=t.call(this,e)).formatters={first_seen:gt,last_seen:gt},n.onInputChange=function(e){n.props.tableChanged("search",{searchText:e.target.value}),n.setState({firstRowIndex:0,currentPage:1,updatePagination:Math.random()})},n.sortTable=function(e){var t="ASC";e===n.state.sortHeader&&(t="ASC"===n.state.sortDirection?"DESC":"ASC");var a={ASC:[-1,1],DESC:[1,-1]};n.props.data.sort((function(n,r){return n[e]<r[e]?a[t][0]:a[t][1]})),n.setState({sortDirection:t,sortHeader:e})};var r=10;return e.data.length>1e4&&(r=100),e.data.length>1e5&&(r=1e3),n.state={currentPageSize:r,firstRowIndex:0,currentPage:1,updatePagination:Math.random(),sortDirection:"ASC"},n}return Object(h.a)(a,[{key:"render",value:function(){var e=this,t=this.props.data.slice(this.state.firstRowIndex,this.state.firstRowIndex+this.state.currentPageSize);return l.a.createElement(tt.a,{useZebraStyles:!0,isSortable:!0,rows:t,headers:this.props.headers,render:function(t){var n=t.rows,r=t.getRowProps,s=t.headers,o=t.getHeaderProps,c=t.selectedRows,u=t.getSelectionProps,i=t.getTableProps,d=t.getBatchActionProps;return l.a.createElement(lt,null,l.a.createElement(mt,null,l.a.createElement(bt,Object.assign({},d(),{translateWithId:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return M.t(e,{totalSelected:t.totalSelected})}}),l.a.createElement(vt,{renderIcon:$e.m,onClick:function(t){return e.props.deleteItem(c)}},M.t("data.table.elements.delete"))),l.a.createElement(yt,null,!e.props.innerTable&&l.a.createElement(kt,{onChange:e.onInputChange,translateWithId:function(e){return M.t(e)}}),l.a.createElement(I.a,{onClick:e.props.addItem,size:"small",kind:"primary",className:"btn-table"},M.t("data.table.elements.add")),!e.props.innerTable&&l.a.createElement(l.a.Fragment,null,l.a.createElement(I.a,{onClick:e.props.bulkAddItem,size:"small",kind:"primary",className:"btn-table"},M.t("data.table.elements.bulk")),l.a.createElement(I.a,{onClick:e.props.importItems,size:"small",kind:"primary",className:"btn-table"},M.t("data.table.elements.import")),l.a.createElement(I.a,{onClick:e.props.exportItems,size:"small",kind:"primary",className:"btn-table"},M.t("data.table.elements.export"))))),l.a.createElement(ot,i(),l.a.createElement(ct,null,l.a.createElement(ut,null,e.props.expandable&&l.a.createElement(at.a,{ariaLabel:"Expand Row",isExpanded:!0,onExpand:function(e){return e}}),l.a.createElement(ft,u()),s.map((function(t){return l.a.createElement(pt,Object.assign({},o({header:t}),{sortDirection:e.state.sortDirection,isSortHeader:e.state.sortHeader===t.key,onClick:function(){return e.sortTable(t.key)}}),t.header)})))),l.a.createElement(it,null,e.props.expandable&&n.map((function(t){return l.a.createElement(l.a.Fragment,{key:t.id},l.a.createElement(nt.a,r({row:t}),l.a.createElement(ht,u({row:t})),t.cells.map((function(e){return l.a.createElement(dt,{key:e.id},e.value)}))),t.isExpanded&&l.a.createElement(rt.a,{colSpan:s.length+2},function(t){return l.a.createElement("div",{id:"inner-table"},l.a.createElement(a,{innerTable:!0,data:t.values,headers:e.props.extendableHeaders,addItem:function(a){return e.props.addInnerItem(t)},deleteItem:function(a){return e.props.deleteInnerItem(t.key,a)},searchText:e.props.innerSearchText}))}(e.props.data.find((function(e){return e.key===t.id})))))})),!e.props.expandable&&n.map((function(t){return l.a.createElement(ut,Object.assign({key:t.id},r({row:t})),l.a.createElement(ht,u({row:t})),t.cells.map((function(t){var a=t.id.substring(t.id.lastIndexOf(":")+1),n=t.value;return a in e.formatters&&(n=e.formatters[a](n)),l.a.createElement(dt,{key:t.id},n)})))})))),l.a.createElement(st.a,{key:e.state.currentPage*e.props.data.length*e.state.updatePagination,page:e.state.currentPage,pageSize:e.state.currentPageSize,pageSizes:[10,30,50,100,1e3],totalItems:e.props.data.length,itemsPerPageText:M.t("carbon.table.pagination.items.per.page"),pageRangeText:function(e,t){return M.t("carbon.table.pagination.pages.total",{total:t})},itemRangeText:function(e,t,a){return M.t("carbon.table.pagination.items.total",{min:e,max:t,total:a})},onChange:function(t){var a=t.page,n=t.pageSize;return e.setState({firstRowIndex:n*(a-1),currentPageSize:n})}}))}})}}]),a}(s.Component),Et=a(228),xt=a(229),It=tt.a.Table,St=tt.a.TableHead,Ot=tt.a.TableRow,_t=tt.a.TableBody,jt=tt.a.TableCell,Dt=tt.a.TableHeader;var Tt,Ct=function(e){var t;return t=e.dependents&&e.dependents.length>0?e.dependents.map((function(e,t){return{id:t,dependent:"("+e.dependent_type+") "+e.dependent_name}})):[{id:"0",dependent:M.t("data.dependents.none")}],e.loaded?l.a.createElement(tt.a,{headers:[{header:M.t("data.dependents.title"),key:"dependent"}],rows:t,useZebraStyles:!0,render:function(t){var a=t.rows,n=t.headers,r=t.getTableProps,s=t.getHeaderProps,o=t.getRowProps;return l.a.createElement(It,r(),l.a.createElement(St,null,l.a.createElement(Ot,null,n.map((function(e){return l.a.createElement(Dt,s({header:e}),e.header)})))),l.a.createElement(_t,null,a.map((function(t){return l.a.createElement(Ot,Object.assign({key:t.id},o({row:t})),t.cells.map((function(a){return l.a.createElement(jt,{key:a.id},e.dependents&&e.dependents.length&&["CRE_RULE","BUILDING_BLOCK","ADE_RULE"].includes(e.dependents[t.id].dependent_type)?l.a.createElement(Et.a,{href:"#",onClick:function(a){a.preventDefault(),e.editRule(e.dependents[t.id].dependent_id)}},a.value):l.a.createElement("label",null,a.value))})))}))))}}):l.a.createElement(xt.a,{headers:[M.t("data.dependents.title")],columnCount:1,rowCount:1})},At=a(243),Mt=a(230),Lt=a(241),Rt=a(231),Nt=a(242),zt=a(232),Ft=a(233),Vt=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).handleChange=function(e,t,a){var r=n.state.entries,s=n.state.filename;a?(r[t].value=a.addedFiles[0],s=a.addedFiles[0].name):"checkbox"===r[t].type?r[t].value=e:r[t].value=e.target.value,n.setState({entries:r,filename:s})},n.state={entries:n.props.entries,filename:"",show:!1},n}return Object(h.a)(a,[{key:"componentDidUpdate",value:function(){this.props.modal!==this.state.show&&this.setState({entries:JSON.parse(JSON.stringify(this.props.entries)),show:this.props.modal,filename:""})}},{key:"label",value:function(e){return this.state.entries[e].help?l.a.createElement(At.a,{direction:"right",triggerText:this.state.entries[e].label},this.state.entries[e].help):l.a.createElement(Mt.a,null,this.state.entries[e].label)}},{key:"render",value:function(){var e=this,t=M.t("data.table.elements.add.file.placeholder");return l.a.createElement(Lt.a,{size:"sm",open:this.props.modal,onRequestSubmit:function(){e.props.save(e.state.entries),e.props.closeModal()},onRequestClose:this.props.closeModal,modalHeading:M.t("data.table.elements.add.title"),primaryButtonText:M.t("data.table.elements.add.save"),secondaryButtonText:M.t("data.table.elements.add.close")},l.a.createElement(Ye.e,{id:"input-modal"},l.a.createElement(Ye.a,null,Object.keys(this.state.entries).map((function(a){return l.a.createElement(Ye.d,{className:"input-modal-entry"},{file:l.a.createElement(Rt.a,{id:a,multiple:!1,labelText:e.state.filename||t,onAddFiles:function(t,n){return e.handleChange(t,a,n)}}),text:l.a.createElement(Nt.a,{id:a,labelText:e.label(a),value:e.state.entries[a].value,onChange:function(t){return e.handleChange(t,a)}}),textarea:l.a.createElement(zt.a,{id:a,labelText:e.label(a),value:e.state.entries[a].value,onChange:function(t){return e.handleChange(t,a)}}),checkbox:l.a.createElement(Ft.a,{defaultChecked:!0,id:a,labelText:e.label(a),value:e.state.entries[a].value,onChange:function(t){return e.handleChange(t,a)}})}[e.state.entries[a].type])})))))}}]),a}(s.Component),Kt=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(e,r){var s;return Object(f.a)(this,a),(s=t.call(this,e)).defaultEntryComment=Object(m.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Tt){e.next=2;break}return e.abrupt("return",Tt);case 2:return e.prev=2,e.next=5,V.QRadar.getCurrentUser();case 5:(t=e.sent)&&!t.error&&(Tt=t.username),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0);case 12:return e.abrupt("return",Tt);case 14:case"end":return e.stop()}}),e,null,[[2,9]])}))),s.updateMetaData=function(e){var t=s.state.metaData;t.number_of_elements=e.number_of_elements,s.setState({metaData:t}),s.props.dataUpdated()},s.loadData=function(){var e=Object(m.a)(p.a.mark((function e(t){var a,n,r,l,o,c,i,d,m;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.loadDependents(),r=0,l=0,o=n=5e3;case 5:return c={Range:"items=".concat(l,"-").concat(o)},e.next=9,ne(s.props.type,s.props.name,c);case 9:if(!(a=e.sent).error){e.next=14;break}return s.props.showError("Unable to load all elements"),s.setState({loaded:!0}),e.abrupt("return");case 14:if(!s.props.size&&a.number_of_elements&&(r=a.number_of_elements),i=t?[]:s.state.allEntries,t=!1,!a.data){e.next=36;break}return m=s.parseResponseData(a),i?(d=i).push.apply(d,Object(u.a)(m)):i=m,e.next=22,s.setState({allEntries:i});case 22:if(delete a.data,s.tableChanged(),!(r&&r>o)){e.next=32;break}a.number_of_elements=o+1,s.setState({metaData:a}),l=o+1,o+=n,console.log("Loading next batch from ".concat(l," to ").concat(o)),e.next=34;break;case 32:return console.log("Done loading all elements"),e.abrupt("break",40);case 34:e.next=38;break;case 36:return console.log("Last batch did not return any new elements. Terminating"),e.abrupt("break",40);case 38:e.next=5;break;case 40:s.setState({metaData:a,loaded:!0});case 41:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.loadDependents=Object(m.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=function(e){if(e.error)return s.props.showError("Unable to load dependents"),void s.setState({dependentsLoaded:!0});s.setState({dependents:e,dependentsLoaded:!0})},se(s.props.type,s.props.name,t);case 2:case"end":return e.stop()}}),e)}))),s.purgeData=function(){s.props.displayLoadingModal(!0);!function(e,t,a,n){de.apply(this,arguments)}(s.props.type,s.props.name,(function(e){s.tableChanged("new",[]),s.updateMetaData(e),s.props.displayLoadingModal(!1)}))},s.reload=Object(m.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.props.displayLoadingModal(!0),e.next=3,s.loadData(!0);case 3:s.props.displayLoadingModal(!1);case 4:case"end":return e.stop()}}),e)}))),s.clickAddItem=function(){s.setState({showInputModal:!0,modalSave:s.addItem,modalInputDefinition:n[s.type+"AddItem"]})},s.clickAddInnerItem=function(e){s.setState({showInputModal:!0,modalSave:function(t){return s.addInnerItem(e,t)},modalInputDefinition:n[s.type+"AddInnerItem"]})},s.clickBulkAddItem=function(){s.setState({showInputModal:!0,modalSave:s.bulkAddItems,modalInputDefinition:n[s.type+"BulkAddItems"]})},s.clickImportItems=function(){s.setState({showInputModal:!0,modalSave:s.importItems,modalInputDefinition:n[s.type+"ImportItems"]})},s.clickDeleteItem=function(e){s.deleteItem(e)},s.clickDeleteInnerItem=function(e,t){s.deleteInnerItem(e,t)},s.tableChanged=function(e,t){var a=s.state.allEntries,n=s.state.searchText;"search"===e&&t&&(n=t.searchText),"new"===e&&t&&(a=t);var r=[],l=!1;try{n=new RegExp(n,"gi"),l=!0}catch(sa){}var o,c=0,u=Object(N.a)(a);try{for(u.s();!(o=u.n()).done;){var i=o.value;s.testValue(i,n,l)&&(i.index=c++,r.push(i))}}catch(d){u.e(d)}finally{u.f()}s.setState({tableData:r,searchText:n,allEntries:a})},s.getIFrameDoc=function(e){return e.contentDocument||e.contentWindow.document},s.showEditRuleModal=function(e){if(s.state.editRuleModalOpen)s.closeRuleModal();else{s.setState((function(e){return{editRuleModalOpen:!0}}));var t=setInterval((function(){if(void 0!==window.frames.rulesWindow){window.frames.rulesWindow.location.href=H.ruleWizardBase+e,clearInterval(t);var a=0,n=setInterval((function(){try{var e=s.getIFrameDoc(document.getElementById("ruleWizardFrame")),t=s.getIFrameDoc(e.getElementById("navigation")),r=t.getElementById("closeButton");t.getElementById("finishButton").addEventListener("click",s.saveRule),r.addEventListener("click",s.closeRuleModal),clearInterval(n)}catch(l){a++>=20&&(clearInterval(n),console.log("Something went wrong with registering the close handlers for the frame. Frame can be closed by clicking in the window background"),console.log(l))}}),1e3)}}),100)}},s.saveRule=function(){setTimeout((function(){var e=this.getIFrameDoc(document.getElementById("ruleWizardFrame"));this.getIFrameDoc(e.getElementById("content")).getElementsByTagName("body")[0].hasAttribute("onload")?this.closeRuleModal():document.getElementsByClassName("errorMessage").length>0||this.saveRule()}),400)},s.closeRuleModal=function(){return s.setState({editRuleModalOpen:!1})},s.type=r,s.headers={set:Ke,map:Pe,map_of_sets:He,map_of_setsInner:Be,table:qe,tableInner:Ue},s.state={metaData:{},allEntries:[],tableData:[],loaded:!1,searchText:"",modalInputDefinition:{}},s.loadData(),s}return Object(h.a)(a,[{key:"download",value:function(e,t,a,n){var r="";n&&(r+="parentKey,"),a&&(r+="key,"),r+="value,first_seen,last_seen,source\n";var s,l=Object(N.a)(t);try{for(l.s();!(s=l.n()).done;){var o=s.value;n&&(r+='"'+(o.outer_key||"").replace(/"/g,'""')+'",'),a&&(r+='"'+(o.key||"").replace(/"/g,'""')+'",'),r+='"'+(o.value||"").replace(/"/g,'""')+'","'+o.first_seen+'","'+o.last_seen+'","'+(o.source||"").replace(/"/g,'""')+'"\n'}}catch(u){l.e(u)}finally{l.f()}var c=new Blob([r],{type:"text/csv"});Ge.a.saveAs(c,"".concat(e,".csv"))}},{key:"render",value:function(){var e=this;return l.a.createElement(l.a.Fragment,null,l.a.createElement(Vt,{modal:this.state.showInputModal,save:this.state.modalSave,entries:JSON.parse(JSON.stringify(this.state.modalInputDefinition)),closeModal:function(t){return e.setState((function(e){return{showInputModal:!e.showInputModal}}))}}),l.a.createElement(Lt.a,{className:"rule-wizard-modal",size:"sm",open:this.state.editRuleModalOpen,passiveModal:!0,onRequestClose:this.closeRuleModal},l.a.createElement("iframe",{id:"ruleWizardFrame",name:"rulesWindow",className:"rule-wizard-frame"})),l.a.createElement(et,{data:this.state.metaData,typeLabel:this.type,deleteEntry:this.props.deleteEntry,purgeData:this.purgeData,reload:this.reload}),this.state.loaded?l.a.createElement(wt,{tableChanged:this.tableChanged,data:this.state.tableData,headers:this.state.headers||this.headers[this.type],type:this.type,addItem:this.clickAddItem,bulkAddItem:this.clickBulkAddItem,importItems:this.clickImportItems,exportItems:this.exportItems,deleteItem:this.clickDeleteItem,searchText:this.state.searchText,expandable:["map_of_sets","table"].includes(this.type),extendableHeaders:this.headers[this.type+"Inner"],addInnerItem:this.clickAddInnerItem,deleteInnerItem:this.clickDeleteInnerItem,innerSearchText:this.state.innerSearchText}):l.a.createElement(xt.a,{rowCount:Math.min(10,this.props.size+1||1),columnCount:this.headers[this.type].length}),l.a.createElement("div",{id:"separator"}),l.a.createElement(Ct,{dependents:this.state.dependents,loaded:this.state.dependentsLoaded,editRule:this.showEditRuleModal}))}}]),a}(s.Component),Pt=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e,"set")).addItem=function(){var e=Object(m.a)(p.a.mark((function e(t){var a,r,s,l,o,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.value.value){e.next=2;break}return e.abrupt("return");case 2:return n.props.displayLoadingModal(!0),e.next=5,n.defaultEntryComment();case 5:return a=e.sent,r=[t.value.value,t.source.value||a],s=r[0],l=r[1],e.next=9,oe(n.props.type,n.props.name,{value:s,source:l});case 9:(o=e.sent).error?n.props.showError(o.message):o.number_of_elements>n.state.tableData.length&&((c=n.state.allEntries).push({value:s,source:l,id:s,first_seen:Date.now(),last_seen:Date.now()}),n.tableChanged("new",c),n.updateMetaData(o)),n.props.displayLoadingModal(!1);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.deleteItem=function(){var e=Object(m.a)(p.a.mark((function e(t){var a,r,s,l,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.length){e.next=2;break}return e.abrupt("return");case 2:n.props.displayLoadingModal(!0),r=n.state.allEntries,s=Object(N.a)(t),e.prev=5,o=p.a.mark((function e(){var t,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.value,s=t.id,e.next=4,ue(n.props.type,n.props.name,s);case 4:a=e.sent,r=r.filter((function(e){return e.value!==s}));case 6:case"end":return e.stop()}}),e)})),s.s();case 8:if((l=s.n()).done){e.next=12;break}return e.delegateYield(o(),"t0",10);case 10:e.next=8;break;case 12:e.next=17;break;case 14:e.prev=14,e.t1=e.catch(5),s.e(e.t1);case 17:return e.prev=17,s.f(),e.finish(17);case 20:a.error||a.number_of_elements>=n.state.tableData.length?n.props.showError(a.message||"Unspecified error while trying to delete value"):(n.tableChanged("new",r),n.updateMetaData(a)),n.props.displayLoadingModal(!1);case 22:case"end":return e.stop()}}),e,null,[[5,14,17,20]])})));return function(t){return e.apply(this,arguments)}}(),n.importItems=function(){var e=Object(m.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(a=new FileReader).onloadend=function(){var e=ye(a.result,t.bulkAddSeparator.value);t.containsHeaders.value&&(e=e.slice(1));var r,s=[],l=Object(N.a)(e);try{for(l.s();!(r=l.n()).done;){var o=r.value,c=Object(i.a)(o,1)[0];s.push(c)}}catch(u){l.e(u)}finally{l.f()}n.bulkAdd(s)},t.file&&t.file.value&&a.readAsText(t.file.value);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.bulkAddItems=function(){var e=Object(m.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.bulkAddData.value.replace(/\r?\n/g,t.bulkAddSeparator.value).split(t.bulkAddSeparator.value).map((function(e){return e.trim()})).filter((function(e){return e})),a=Object(u.a)(new Set(a)),n.bulkAdd(a);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.bulkAdd=function(){var e=Object(m.a)(p.a.mark((function e(t){var a,r,s,l,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.props.displayLoadingModal(!0),e.next=3,be(n.props.type,n.props.name,t);case 3:if((a=e.sent).error)n.props.showError(a.message);else{r=n.state.allEntries,s=Object(N.a)(t);try{for(s.s();!(l=s.n()).done;)o=l.value,r.push({value:o,id:o,source:"reference data api",first_seen:Date.now(),last_seen:Date.now()})}catch(c){s.e(c)}finally{s.f()}r=n.removeDuplicates(r),n.tableChanged("new",r),n.updateMetaData(a)}n.props.displayLoadingModal(!1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.exportItems=function(){return n.download(n.props.name,n.state.allEntries)},n.removeDuplicates=function(e){return e.filter((function(e,t,a){return t===a.findIndex((function(t){return t.value===e.value}))}))},n.parseResponseData=function(e){var t=[];return e.number_of_elements>0&&e.data.forEach((function(e){void 0!==e.value&&(e.id=e.value,t.push(e))})),t},n.testValue=function(e,t,a){if(!e.value)return!1;return a?e.value.match(t):e.value.toLowerCase().includes(t.toLowerCase())},n}return a}(Kt),Ht=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e,"map")).addItem=function(){var e=Object(m.a)(p.a.mark((function e(t){var a,r,s,l,o,c,u;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.value.value&&t.key.value){e.next=2;break}return e.abrupt("return");case 2:return n.props.displayLoadingModal(!0),e.next=5,n.defaultEntryComment();case 5:return a=e.sent,r=[t.key.value,t.value.value,t.source.value||a],s=r[0],l=r[1],o=r[2],e.next=9,oe(n.props.type,n.props.name,{key:s,value:l,source:o});case 9:(c=e.sent).error?n.props.showError(c.message):((u=n.state.allEntries).push({key:s,value:l,source:o,id:s,first_seen:Date.now(),last_seen:Date.now()}),n.tableChanged("new",u),n.updateMetaData(c)),n.props.displayLoadingModal(!1);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.deleteItem=function(){var e=Object(m.a)(p.a.mark((function e(t){var a,r,s,l,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.length){e.next=2;break}return e.abrupt("return");case 2:n.props.displayLoadingModal(!0),r=n.state.allEntries,s=Object(N.a)(t),e.prev=5,o=p.a.mark((function e(){var t,s,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.value,s=t.id,o=r.findIndex((function(e){return e.key===s})),e.next=5,ue(n.props.type,n.props.name,s,{value:r[o].value});case 5:(a=e.sent).error?n.props.showError(a.message):r.splice(o,1);case 7:case"end":return e.stop()}}),e)})),s.s();case 8:if((l=s.n()).done){e.next=12;break}return e.delegateYield(o(),"t0",10);case 10:e.next=8;break;case 12:e.next=17;break;case 14:e.prev=14,e.t1=e.catch(5),s.e(e.t1);case 17:return e.prev=17,s.f(),e.finish(17);case 20:a.error?n.props.showError(a.message):(n.tableChanged("new",r),n.updateMetaData(a)),n.props.displayLoadingModal(!1);case 22:case"end":return e.stop()}}),e,null,[[5,14,17,20]])})));return function(t){return e.apply(this,arguments)}}(),n.importItems=function(){var e=Object(m.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(a=new FileReader).onloadend=function(){var e=ye(a.result,t.bulkAddSeparator.value);t.containsHeaders.value&&(e=e.slice(1));var r,s={},l=Object(N.a)(e);try{for(l.s();!(r=l.n()).done;){var o=r.value,c=Object(i.a)(o,2),u=c[0],d=c[1];s[u]=d}}catch(p){l.e(p)}finally{l.f()}n.bulkAdd(s)},t.file&&t.file.value&&a.readAsText(t.file.value);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.bulkAddItems=function(){var e=Object(m.a)(p.a.mark((function e(t){var a,r,s,l,o,c,u,d,m;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.bulkAddData.value.split(/\r?\n/g).map((function(e){return e.trim()})).filter((function(e){return e})),r={},s=Object(N.a)(a);try{for(s.s();!(l=s.n()).done;)o=l.value,c=o.split(t.bulkAddSeparator.value).map((function(e){return e.trim()})).filter((function(e){return e})),u=Object(i.a)(c,2),d=u[0],m=u[1],r[d]=m}catch(p){s.e(p)}finally{s.f()}n.bulkAdd(r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.bulkAdd=function(){var e=Object(m.a)(p.a.mark((function e(t){var a,r,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.props.displayLoadingModal(!0),e.next=3,be(n.props.type,n.props.name,t);case 3:if((a=e.sent).error)n.props.showError(a.message);else{for(s in r=n.state.allEntries,t)r.push({key:s,value:t[s],id:s,source:"reference data api",first_seen:Date.now(),last_seen:Date.now()});r=n.removeDuplicates(r),n.tableChanged("new",r),n.updateMetaData(a)}n.props.displayLoadingModal(!1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.exportItems=function(){return n.download(n.props.name,n.state.allEntries,!0)},n.removeDuplicates=function(e){return e.reverse().filter((function(e,t,a){return t===a.findIndex((function(t){return t.key===e.key}))})).reverse()},n.parseResponseData=function(e){var t=[];if(e.number_of_elements>0){for(var a in e.data)void 0!==a&&t.push(Object(x.a)({key:a},e.data[a],{id:a}));return t}},n.testValue=function(e,t,a){if(!e.value||!e.key)return!1;return a?e.value.match(t)||e.key.match(t):e.value.toLowerCase().includes(t.toLowerCase())||e.key.toLowerCase().includes(t.toLowerCase())},n}return a}(Kt),Bt=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e,"map_of_sets")).addItem=function(){var e=Object(m.a)(p.a.mark((function e(t){var a,r,s,l,o,c,i,d,m;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.keyAddDataValues.value.replace(/\r?\n/g,t.keyAddSeparator.value).split(t.keyAddSeparator.value).map((function(e){return e.trim()})).filter((function(e){return e})),0!==(a=Object(u.a)(new Set(a))).length){e.next=4;break}return e.abrupt("return");case 4:return r=t.keyAddDataKey.value,s=Object(E.a)({},r,a),n.props.displayLoadingModal(!0),e.next=9,be(n.props.type,n.props.name,s);case 9:if((l=e.sent).error)n.props.showError(l.message);else{if(o=n.state.allEntries,-1===(c=o.findIndex((function(e){return e.key===r}))))a=a.map((function(e){return{key:r,value:e,id:e,source:"reference data api"}})),o.push({key:r,values:a,id:r});else{i=Object(N.a)(a);try{for(m=function(){var e=d.value;-1===o[c].values.findIndex((function(t){return t.value===e}))&&o[c].values.push({key:r,value:e,id:e,source:"reference data api"})},i.s();!(d=i.n()).done;)m()}catch(p){i.e(p)}finally{i.f()}}n.tableChanged("new",o),n.updateMetaData(l)}n.props.displayLoadingModal(!1);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.deleteItem=function(){var e=Object(m.a)(p.a.mark((function e(t){var a,r,s,l,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.length){e.next=2;break}return e.abrupt("return");case 2:n.props.displayLoadingModal(!0),r=n.state.allEntries,s=Object(N.a)(t),e.prev=5,o=p.a.mark((function e(){var t,s,o,c,u,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=l.value,s=t.id,o=r.findIndex((function(e){return e.key===s})),c=Object(N.a)(r[o].values),e.prev=4,c.s();case 6:if((u=c.n()).done){e.next=14;break}return i=u.value,e.next=10,ue(n.props.type,n.props.name,s,{value:i.value});case 10:(a=e.sent).error&&n.props.showError(a.message);case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),c.e(e.t0);case 19:return e.prev=19,c.f(),e.finish(19);case 22:r.splice(o,1);case 23:case"end":return e.stop()}}),e,null,[[4,16,19,22]])})),s.s();case 8:if((l=s.n()).done){e.next=12;break}return e.delegateYield(o(),"t0",10);case 10:e.next=8;break;case 12:e.next=17;break;case 14:e.prev=14,e.t1=e.catch(5),s.e(e.t1);case 17:return e.prev=17,s.f(),e.finish(17);case 20:a.error?n.props.showError(a.message):(n.tableChanged("new",r),n.updateMetaData(a)),n.props.displayLoadingModal(!1);case 22:case"end":return e.stop()}}),e,null,[[5,14,17,20]])})));return function(t){return e.apply(this,arguments)}}(),n.addInnerItem=function(){var e=Object(m.a)(p.a.mark((function e(t,a){var r,s,l,o,c,u,i,d;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.defaultEntryComment();case 2:if(r=e.sent,s=[a.value.value,t.key,a.source.value||r],l=s[0],o=s[1],c=s[2],u=n.state.allEntries.findIndex((function(e){return e.key===o})),-1===n.state.allEntries[u].values.findIndex((function(e){return e.value===e}))){e.next=8;break}return n.props.showError("Value already in table."),e.abrupt("return");case 8:return n.props.displayLoadingModal(!0),e.next=11,oe(n.props.type,n.props.name,{value:l,key:o,source:c});case 11:(i=e.sent).error?n.props.showError(i.message):((d=n.state.allEntries)[u].values.push({value:l,key:o,source:c,id:l,first_seen:Date.now(),last_seen:Date.now()}),n.tableChanged("new",d),n.updateMetaData(i)),n.props.displayLoadingModal(!1);case 14:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),n.deleteInnerItem=function(){var e=Object(m.a)(p.a.mark((function e(t,a){var r,s,l,o,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a&&a.length){e.next=2;break}return e.abrupt("return");case 2:n.props.displayLoadingModal(!0),s=n.state.allEntries,l=Object(N.a)(a),e.prev=5,c=p.a.mark((function e(){var a,l,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.value,l=a.id,c=s.findIndex((function(e){return e.key===t})),e.next=5,ue(n.props.type,n.props.name,t,{value:l});case 5:(r=e.sent).error?n.props.showError(r.message):s[c].values=s[c].values.filter((function(e){return e.value!==l})),0===s[c].values.length&&s.splice(c,1);case 8:case"end":return e.stop()}}),e)})),l.s();case 8:if((o=l.n()).done){e.next=12;break}return e.delegateYield(c(),"t0",10);case 10:e.next=8;break;case 12:e.next=17;break;case 14:e.prev=14,e.t1=e.catch(5),l.e(e.t1);case 17:return e.prev=17,l.f(),e.finish(17);case 20:r.error?n.props.showError(r.message):(n.tableChanged("new",s),n.updateMetaData(r)),n.props.displayLoadingModal(!1);case 22:case"end":return e.stop()}}),e,null,[[5,14,17,20]])})));return function(t,a){return e.apply(this,arguments)}}(),n.importItems=function(){var e=Object(m.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(a=new FileReader).onloadend=function(){var e=ye(a.result,t.bulkAddSeparator.value);t.containsHeaders.value&&(e=e.slice(1));var r,s={},l=Object(N.a)(e);try{for(l.s();!(r=l.n()).done;){var o=r.value,c=Object(i.a)(o,2),u=c[0],d=c[1];s.hasOwnProperty(u)||(s[u]=[]),s[u].push(d.trim())}}catch(p){l.e(p)}finally{l.f()}n.bulkAdd(s)},t.file&&t.file.value&&a.readAsText(t.file.value);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.exportItems=function(){var e,t=[],a=Object(N.a)(n.state.allEntries);try{for(a.s();!(e=a.n()).done;){var r=e.value;t.push.apply(t,Object(u.a)(r.values))}}catch(s){a.e(s)}finally{a.f()}n.download(n.props.name,t,!0,!1)},n.bulkAddItems=function(){var e=Object(m.a)(p.a.mark((function e(t){var a,r,s,l,o,c,u,d,m;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.bulkAddData.value.split(/\r?\n/g).map((function(e){return e.trim()})).filter((function(e){return e})),r={},s=Object(N.a)(a);try{for(s.s();!(l=s.n()).done;)o=l.value,c=o.split(t.bulkAddSeparator.value).map((function(e){return e.trim()})).filter((function(e){return e})),u=Object(i.a)(c,2),d=u[0],m=u[1],r.hasOwnProperty(d)||(r[d]=[]),r[d].push(m)}catch(p){s.e(p)}finally{s.f()}n.bulkAdd(r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.bulkAdd=function(){var e=Object(m.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.props.displayLoadingModal(!0),e.next=3,be(n.props.type,n.props.name,t);case 3:return(a=e.sent).error?n.props.showError(a.message):n.updateMetaData(a),e.next=7,n.loadData(n.props.type,!0);case 7:n.props.displayLoadingModal(!1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.parseResponseData=function(e){var t=[];if(e.number_of_elements>0){var a=function(t){e.data[t]=e.data[t].map((function(e){return Object(x.a)({key:t,id:e.value},e)}))};for(var n in e.data)a(n);t=Object.keys(e.data).map((function(t){return{key:t,values:e.data[t],valueLabel:e.value_label,id:t}}))}return t},n.testValue=function(e,t,a){try{if(a?e.key.match(t):e.key.toLowerCase().includes(t.toLowerCase()))return!0;var n,r=Object(N.a)(e.values);try{for(r.s();!(n=r.n()).done;){var s=n.value;if(a?s.value.match(t):s.value.toLowerCase().includes(t.toLowerCase()))return!0}}catch(l){r.e(l)}finally{r.f()}}catch(sa){return!1}return!1},n}return a}(Kt),qt=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e,"table")).clickAddItem=function(){var e={};if(n.state.metaData)for(var t in n.state.metaData.key_name_types)e[t]={label:t,value:"",type:"text",element_type:n.state.metaData.key_name_types[t]};var a=Object(x.a)({outer_key:{label:n.state.metaData.key_label||"Key",value:"",type:"text"}},e,{source:{label:"Comment",value:"",type:"text",help:"Optional: A comment to add to the new data entry"}});n.setState({showInputModal:!0,modalSave:n.addItem,modalInputDefinition:a})},n.addItem=function(){var e=Object(m.a)(p.a.mark((function e(t){var a,r,s,l,o,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.state.allEntries,s=[t.outer_key.value,t.source.value],o=s[1],l=s[0]){e.next=4;break}return e.abrupt("return");case 4:n.props.displayLoadingModal(!0),-1===r.findIndex((function(e){return e.key===l}))&&r.push({key:l,values:[],id:l}),n.tableChanged("new",r),delete t.outer_key,delete t.source,e.t0=p.a.keys(t);case 11:if((e.t1=e.t0()).done){e.next=20;break}if(c=e.t1.value,t[c].value){e.next=15;break}return e.abrupt("continue",11);case 15:return e.next=17,n.addInnerItem({key:l},{key:{value:c},value:{value:t[c].value},source:{value:o}},!0);case 17:a=e.sent,e.next=11;break;case 20:n.updateMetaData(a),n.props.displayLoadingModal(!1);case 22:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.deleteItem=function(){var e=Object(m.a)(p.a.mark((function e(t){var a,r,s,l,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.length){e.next=2;break}return e.abrupt("return");case 2:n.props.displayLoadingModal(!0),r=n.state.allEntries,s=Object(N.a)(t),e.prev=5,o=p.a.mark((function e(){var t,s,o,c,u,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=l.value,s=t.id,o=r.findIndex((function(e){return e.key===s})),c=Object(N.a)(r[o].values),e.prev=4,i=p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.value,e.next=3,fe(n.props.type,n.props.name,s,t.key,{value:t.value});case 3:(a=e.sent).error?n.props.showError(a.message):r[o].values=r[o].values.filter((function(e){return e.key!==t.key}));case 5:case"end":return e.stop()}}),e)})),c.s();case 7:if((u=c.n()).done){e.next=11;break}return e.delegateYield(i(),"t0",9);case 9:e.next=7;break;case 11:e.next=16;break;case 13:e.prev=13,e.t1=e.catch(4),c.e(e.t1);case 16:return e.prev=16,c.f(),e.finish(16);case 19:0===r[o].values.length&&r.splice(o,1);case 20:case"end":return e.stop()}}),e,null,[[4,13,16,19]])})),s.s();case 8:if((l=s.n()).done){e.next=12;break}return e.delegateYield(o(),"t0",10);case 10:e.next=8;break;case 12:e.next=17;break;case 14:e.prev=14,e.t1=e.catch(5),s.e(e.t1);case 17:return e.prev=17,s.f(),e.finish(17);case 20:a.error?n.props.showError(a.message):(n.tableChanged("new",r),n.updateMetaData(a)),n.props.displayLoadingModal(!1);case 22:case"end":return e.stop()}}),e,null,[[5,14,17,20]])})));return function(t){return e.apply(this,arguments)}}(),n.addInnerItem=function(){var e=Object(m.a)(p.a.mark((function e(t,a,r){var s,l,o,c,u,i,d,m,f,h,b;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.defaultEntryComment();case 2:if(s=e.sent,l=[t.key,a.key.value,a.value.value,a.source.value||s],o=l[0],c=l[1],u=l[2],i=l[3],d=n.state.allEntries,o&&c&&u){e.next=7;break}return e.abrupt("return");case 7:return n.props.displayLoadingModal(!0),e.next=10,oe(n.props.type,n.props.name,{outer_key:o,inner_key:c,value:u,source:i});case 10:if((m=e.sent).error?n.props.showError(m.message):(f=d.findIndex((function(e){return e.key===o})),h=d[f].values.findIndex((function(e){return e.key===c})),b={outer_key:o,key:c,value:u,source:i,id:c,first_seen:Date.now(),last_seen:Date.now()},-1===h?d[f].values.push(b):d[h].values[h]=b,n.updateMetaData(m),n.tableChanged("new",d)),!r){e.next=16;break}return e.abrupt("return",m);case 16:n.props.displayLoadingModal(!1);case 17:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),n.deleteInnerItem=function(){var e=Object(m.a)(p.a.mark((function e(t,a){var r,s,l,o,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a&&a.length){e.next=2;break}return e.abrupt("return");case 2:n.props.displayLoadingModal(!0),s=n.state.allEntries,l=Object(N.a)(a),e.prev=5,c=p.a.mark((function e(){var a,l,c,u;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.value,l=a.id,c=s.findIndex((function(e){return e.key===t})),u=s[c].values.findIndex((function(e){return e.key===l})),e.next=6,fe(n.props.type,n.props.name,t,l,{value:s[c].values[u].value});case 6:(r=e.sent).error?n.props.showError(r.message):s[c].values.splice(u,1),0===s[c].values.length&&s.splice(c,1);case 9:case"end":return e.stop()}}),e)})),l.s();case 8:if((o=l.n()).done){e.next=12;break}return e.delegateYield(c(),"t0",10);case 10:e.next=8;break;case 12:e.next=17;break;case 14:e.prev=14,e.t1=e.catch(5),l.e(e.t1);case 17:return e.prev=17,l.f(),e.finish(17);case 20:r.error?n.props.showError(r.message):(n.tableChanged("new",s),n.updateMetaData(r)),n.props.displayLoadingModal(!1);case 22:case"end":return e.stop()}}),e,null,[[5,14,17,20]])})));return function(t,a){return e.apply(this,arguments)}}(),n.importItems=function(){var e=Object(m.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(a=new FileReader).onloadend=function(){var e=ye(a.result,t.bulkAddSeparator.value);t.containsHeaders.value&&(e=e.slice(1));var r,s={},l=Object(N.a)(e);try{for(l.s();!(r=l.n()).done;){var o=r.value,c=Object(i.a)(o,3),u=c[0],d=c[1],p=c[2];s.hasOwnProperty(u)||(s[u]={}),s[u][d]=p}}catch(m){l.e(m)}finally{l.f()}n.bulkAdd(s)},t.file&&t.file.value&&a.readAsText(t.file.value);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.exportItems=function(){var e,t=[],a=Object(N.a)(n.state.allEntries);try{for(a.s();!(e=a.n()).done;){var r=e.value;t.push.apply(t,Object(u.a)(r.values))}}catch(s){a.e(s)}finally{a.f()}n.download(n.props.name,t,!0,!0)},n.bulkAddItems=function(){var e=Object(m.a)(p.a.mark((function e(t){var a,r,s,l,o,c,u,d,m,f;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.bulkAddData.value.split(/\r?\n/g).map((function(e){return e.trim()})).filter((function(e){return e})),r={},s=Object(N.a)(a);try{for(s.s();!(l=s.n()).done;)o=l.value,c=o.split(t.bulkAddSeparator.value).map((function(e){return e.trim()})).filter((function(e){return e})),u=Object(i.a)(c,3),d=u[0],m=u[1],f=u[2],r.hasOwnProperty(d)||(r[d]={}),r[d][m]=f}catch(p){s.e(p)}finally{s.f()}n.bulkAdd(r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.bulkAdd=function(){var e=Object(m.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.props.displayLoadingModal(!0),e.next=3,be(n.props.type,n.props.name,t);case 3:return(a=e.sent).error?n.props.showError(a.message):n.updateMetaData(a),e.next=7,n.loadData(n.props.type,!0);case 7:n.props.displayLoadingModal(!1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.parseResponseData=function(e){var t=[];if(e.number_of_elements>0){for(var a in e.data)for(var n in e.data[a])e.data[a][n]=Object(x.a)({outer_key:a,key:n,id:n},e.data[a][n]);t=Object.keys(e.data).map((function(t){return{key:t,values:Object.values(e.data[t]),id:t}}))}return t},n.tableChangedXX=function(e,t){var a=[{key:"key",header:"IoC"}],r=["key"];if(n.state.metaData)for(var s in n.state.metaData.key_name_types)a.push({key:s,header:s}),r.push(s);var l=n.state.allEntries,o=n.state.searchText;"search"===e&&t&&(o=t.searchText),"new"===e&&t&&(l=t);var c=[],u=!1;try{o=new RegExp(o,"gi"),u=!0}catch(sa){}var i,d=0,p=Object(N.a)(l);try{for(p.s();!(i=p.n()).done;){var m=i.value;if(n.testValue(m,o,u)){var f,h={key:m.key,id:m.key,index:d++},b=Object(N.a)(m.values);try{for(b.s();!(f=b.n()).done;){var v=f.value;h[v.key]=v.value,r.includes(v.key)||(a.push({key:v.key,header:v.key}),r.push(v.key))}}catch(y){b.e(y)}finally{b.f()}c.push(h)}}}catch(y){p.e(y)}finally{p.f()}console.log(c,a),n.setState({tableData:c,searchText:o,allEntries:l,headers:a})},n.testValue=function(e,t,a){try{if(a?e.key.match(t):e.key.toLowerCase().includes(t.toLowerCase()))return!0;var n,r=Object(N.a)(e.values);try{for(r.s();!(n=r.n()).done;){var s=n.value;if(a?s.value.match(t):s.value.toLowerCase().includes(t.toLowerCase()))return!0}}catch(l){r.e(l)}finally{r.f()}}catch(sa){return!1}return!1},n}return a}(Kt),Ut=a(234),Wt=a(235),Gt=a(239);function Jt(e){var t={};Object.keys(e.values).forEach((function(a){t[a]=e.values[a]}));var a=Object(s.useState)(2),n=Object(i.a)(a,2),r=n[0],o=n[1],c=Object(s.useState)(t),u=Object(i.a)(c,2),d=u[0],p=u[1];return l.a.createElement("div",{className:"inner-keys"},Object.keys(d).map((function(t){return l.a.createElement("div",{className:"input-group",key:t},l.a.createElement(Gt.a,{className:"create-new-dropdown",items:e.options,selectedItem:d[t].type,onChange:function(a){return function(t,a,n){var r=t.selectedItem;p(Object(x.a)({},d,Object(E.a)({},a,Object(E.a)({},n,r)))),e.values[a][n]=r}(a,t,"type")}}),l.a.createElement(Nt.a,{key:t,value:d[t].label,onChange:function(a){return function(t,a,n){var r=t.target.value;p(Object(x.a)({},d,Object(E.a)({},a,Object(E.a)({},n,r)))),e.values[a][n]=r}(a,t,"label")}}),l.a.createElement(I.a,{kind:"danger",size:"small",hasIconOnly:!0,renderIcon:$e.l,iconDescription:"Delete",tooltipPosition:"bottom",className:"delete-inner-key",onClick:function(a){return delete d[n=t],p(Object(x.a)({},d)),void delete e.values[n];var n}}))})),l.a.createElement(I.a,{kind:"tertiary",size:"small",onClick:function(t){return function(t){var a="Inner Key "+r;p(Object(x.a)({},d,Object(E.a)({},a,{label:a,type:"ALN"}))),o(r+1),e.values[a]={label:a,type:"ALN"}}()}},M.t("data.new.add.key.inner")))}function Qt(e){var t=Object(s.useState)(),a=Object(i.a)(t,2),n=a[0],r=a[1],o=Object(s.useState)("days"),c=Object(i.a)(o,2),u=c[0],d=c[1];return l.a.createElement("div",{className:"inner-keys"},l.a.createElement("div",{className:"input-group"},l.a.createElement(Nt.a,{value:n,onChange:function(t){return function(t){var a="";t.target.value&&(a=t.target.value+" "+u),r(t.target.value),e.setValue(a)}(t)}}),l.a.createElement(Gt.a,{className:"create-new-dropdown",selectedItem:u,onChange:function(t){return function(t){var a=n+" "+t.selectedItem;d(t.selectedItem),e.setValue(a)}(t)},items:e.options})))}var Yt=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(e){var r;return Object(f.a)(this,a),(r=t.call(this,e)).state={type:r.props.type,entries:JSON.parse(JSON.stringify(n[r.props.type]))},r.typeLookup={tables:"Table",map_of_sets:"Map of Sets",sets:"Set",maps:"Map"},r}return Object(h.a)(a,[{key:"componentDidUpdate",value:function(){this.state.type!==this.props.type&&this.setState({type:this.props.type,entries:JSON.parse(JSON.stringify(n[this.props.type]))})}},{key:"handleChange",value:function(e,t){var a=this.state.entries;a[t].value=e.target.value,this.setState({entries:a})}},{key:"handleDropdownChange",value:function(e,t){var a=this.state.entries;a[t].value=e.selectedItem,this.setState({entries:a})}},{key:"render",value:function(){var e=this;return l.a.createElement(Ut.a,null,l.a.createElement(Wt.a,{legendText:M.t("data.new.title",{type:this.typeLookup[this.state.type]})}),Object.keys(this.state.entries).map((function(t){var a;switch(e.state.entries[t].type){case"select":a=l.a.createElement(Gt.a,{selectedItem:e.state.entries[t].value,onChange:function(a){return e.handleDropdownChange(a,t)},items:e.state.entries[t].options});break;case"list":a=l.a.createElement(Jt,{options:e.state.entries[t].options,label:e.state.entries[t].label,values:e.state.entries[t].values});break;case"date":a=l.a.createElement(Qt,{options:e.state.entries[t].options,label:e.state.entries[t].label,setValue:function(a){return e.state.entries[t].value=a}});break;default:a=l.a.createElement(Nt.a,{id:t,value:e.state.entries[t].value,onChange:function(a){return e.handleChange(a,t)}})}return l.a.createElement(Wt.a,{key:t},e.state.entries[t].help?l.a.createElement(At.a,{direction:"right",triggerText:e.state.entries[t].label},e.state.entries[t].help):l.a.createElement(Mt.a,null,e.state.entries[t].label),a)})),l.a.createElement(I.a,{kind:"primary",size:"small",onClick:function(){return e.props.save(e.state.entries)}},M.t("data.new.create")))}}]),a}(s.Component),Zt=tt.a.Table,$t=tt.a.TableHead,Xt=tt.a.TableRow,ea=tt.a.TableBody,ta=tt.a.TableCell,aa=tt.a.TableHeader;var na=function(e){var t=Object(s.useState)(""),a=Object(i.a)(t,2),n=a[0],r=a[1],o=Object(s.useState)([]),c=Object(i.a)(o,2),u=c[0],d=c[1],f=Object(s.useState)(void 0),h=Object(i.a)(f,2),b=h[0],v=h[1],y=function(){var t=Object(m.a)(p.a.mark((function t(){var a;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.displayLoadingModal(!0),t.next=3,X(e.type,n);case 3:(a=t.sent).error?e.showError(a.message):((a=a.map((function(e){return Object(x.a)({id:e.name},e)}))).length?d(a):d([{name:M.t("data.search.all.no.results")}]),v(!!a.length)),e.displayLoadingModal(!1);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return l.a.createElement("div",{id:"searchAll"},l.a.createElement(Ut.a,null,l.a.createElement(Wt.a,null,l.a.createElement(Nt.a,{type:"text",value:n,onChange:function(e){r(e.target.value)},labelText:M.t("data.search.all.input"),placeholder:M.t("data.search.all.placeholder")}),l.a.createElement(I.a,{kind:"primary",size:"small",className:"btn-search-all",onClick:y},M.t("data.search.all.button")))),l.a.createElement(tt.a,{headers:[{header:M.t("data.search.all.table.title"),key:"name"}],rows:u,useZebraStyles:!0,render:function(t){var a=t.rows,n=t.headers,r=t.getTableProps,s=t.getHeaderProps,o=t.getRowProps;return l.a.createElement(Zt,r(),l.a.createElement($t,null,l.a.createElement(Xt,null,n.map((function(e){return l.a.createElement(aa,s({header:e}),e.header)})))),l.a.createElement(ea,null,a.map((function(t){return l.a.createElement(Xt,Object.assign({key:t.id},o({row:t})),t.cells.map((function(t){return l.a.createElement(ta,{key:t.id},!1===b?l.a.createElement("label",null,t.value):l.a.createElement(Et.a,{href:"#",onClick:function(a){a.preventDefault(),e.open(void 0,{key:"".concat(e.type,"/").concat(t.value)})}},t.value))})))}))))}}))},ra=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(e){var n;Object(f.a)(this,a),(n=t.call(this,e)).updateTheme=function(e){var t=localStorage.getItem("theme")||"dark",a=document.documentElement;e&&(t="light"==t?"dark":"light",localStorage.setItem("theme",t));var n="light"==t?L.a:L.b;a.classList=[t],a.style.setProperty("--color-inner-table",n)},n.menuItemClicked=function(e,t){e&&e.stopPropagation(),n.updateHash("view/"+t.key),n.setState({updated:!0})},n.createEntry=function(e,t){e.stopPropagation(),n.updateHash("create/"+t),n.setState({updated:!0})},n.searchAll=function(e,t){e.stopPropagation(),n.updateHash("search/"+t),n.setState({updated:!0})},n.entryCreated=function(){var e=Object(m.a)(p.a.mark((function e(t,a){var r,s,l,o,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.displayLoadingModal(!0),r={},t.inner_labels&&(r.outer_key_label=t.key_label.value,s=[],Object.keys(t.inner_labels.values).forEach((function(e){s.push({key_name:t.inner_labels.values[e].label,element_type:t.inner_labels.values[e].type})})),r.key_name_types=JSON.stringify(s)),e.t0=p.a.keys(t);case 4:if((e.t1=e.t0()).done){e.next=11;break}if("key_label"!==(l=e.t1.value)&&"inner_labels"!==l){e.next=8;break}return e.abrupt("continue",4);case 8:r[l]=t[l].value,e.next=4;break;case 11:return e.next=13,te(a,r);case 13:(o=e.sent).error?n.showError(o.message):(c=a+"/"+o.name,n.state.refData[a].nodes[o.name]={label:o.name,size:0,datatype:a,key:c},n.menuItemClicked(void 0,{key:c})),n.displayLoadingModal(!1);case 16:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),n.deleteEntry=Object(m.a)(p.a.mark((function e(){var t,a,r,s,l;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.parseHash(),a=Object(i.a)(t,3),a[0],r=a[1],s=a[2],!window.confirm('Do you really want to delete "'.concat(s,'"'))){e.next=9;break}return n.displayLoadingModal(!0),l=function(e){e.error?n.showError(e.message):(n.updateHash(""),delete n.state.refData[r].nodes[s],n.setState({updated:!0})),n.displayLoadingModal(!1)},e.next=7,pe(r,s,l);case 7:e.next=10;break;case 9:return e.abrupt("return");case 10:case"end":return e.stop()}}),e)}))),n.showError=function(e){var t=n.state.errorMessages;e||(e="An unspecified error occured"),e=Array.isArray(e)?e:[e],t.push.apply(t,Object(u.a)(e)),n.setState({errorMessages:t})},n.getRefData=Object(m.a)(p.a.mark((function e(){var t,a,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.state.refData,a=p.a.mark((function e(a){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z(a);case 2:if(!(r=e.sent).error){e.next=6;break}return n.showError("Unable to load "+t[a].label),e.abrupt("return","continue");case 6:t[a].nodes={},t[a].size=r.length,t[a].datatype=a.replace(/_/g," "),r.sort((function(e,t){return e.name.toLowerCase()>t.name.toLowerCase()?1:-1})),r.forEach((function(e){t[a].nodes[e.name]={label:e.name,size:e.number_of_elements,datatype:a,key:a+"/"+e.name}}));case 11:case"end":return e.stop()}}),e)})),e.t0=p.a.keys(t);case 3:if((e.t1=e.t0()).done){e.next=11;break}return r=e.t1.value,e.delegateYield(a(r),"t2",6);case 6:if("continue"!==e.t2){e.next=9;break}return e.abrupt("continue",3);case 9:e.next=3;break;case 11:n.setState({refData:t});case 12:case"end":return e.stop()}}),e)}))),n.parseHash=function(){var e=decodeURI(window.location.hash.substring("#/data".length)).split("/"),t=Object(i.a)(e,4),a=(t[0],t[1]),r=t[2],s=t[3];return n.supportedActions.includes(a)&&n.supportedTypes.includes(r)?[a,r,s]:["","",""]},n.updateHash=function(e){window.location.hash="/data/"+e,n.setState({errorMessages:[]})},n.displayLoadingModal=function(e){return n.setState({loading:e})},n.supportedActions=["create","view","search"],n.supportedTypes=["maps","sets","map_of_sets","tables"],n.refDataMapping={maps:Ht,sets:Pt,map_of_sets:Bt,tables:qt};var r={sets:{key:"sets",label:M.t("data.sidebar.type",{type:"Set"}),nodes:{}},maps:{key:"maps",label:M.t("data.sidebar.type",{type:"Map"}),nodes:{}},map_of_sets:{key:"map_of_sets",label:M.t("data.sidebar.type",{type:"Map of Sets"}),nodes:{}},tables:{key:"tables",label:M.t("data.sidebar.type",{type:"Table"}),nodes:{}}};return n.state={refData:r,errorMessages:[],loading:!1},n.updateTheme(),n.getRefData(),n}return Object(h.a)(a,[{key:"render",value:function(){var e=this,t="",a="",n="";if(window.location.hash.includes("#/data/")){var r=this.parseHash(),s=Object(i.a)(r,3);t=s[0],a=s[1],n=s[2]}var o=this.refDataMapping[a];return l.a.createElement(w.a,{secondaryInitialSize:84,percentage:!0},l.a.createElement(R,{menuItemAction:this.menuItemClicked,showError:this.showError,createEntry:this.createEntry,searchAll:this.searchAll,refData:this.state.refData,updateTheme:this.updateTheme}),l.a.createElement("div",{id:"content"},l.a.createElement(y.a,{active:this.state.loading,withOverlay:!0}),this.state.errorMessages.length>0&&l.a.createElement(k.a,{kind:"error",id:"error-alert",onCloseButtonClick:function(t){e.setState({errorMessages:[]})},title:"Error"},this.state.errorMessages.map((function(e){return l.a.createElement("span",{key:e,className:"error-alert-message"},e,l.a.createElement("br",null))}))),"create"===t?l.a.createElement(Yt,{type:a,save:function(t){return e.entryCreated(t,a)}}):"search"===t?l.a.createElement(na,{type:a,open:this.menuItemClicked,displayLoadingModal:this.displayLoadingModal,showError:this.showError}):o&&l.a.createElement(o,{key:"".concat(a,"/").concat(n),api:"".concat(a,"/").concat(n),name:n,type:a,deleteEntry:this.deleteEntry,dataUpdated:this.getRefData,displayLoadingModal:this.displayLoadingModal,showError:this.showError})))}}]),a}(s.Component);c.a.render(l.a.createElement(ra,null),document.getElementById("root"))}},[[129,1,2]]]);
//# sourceMappingURL=main.6bab7660.chunk.js.map